{"version":3,"file":"index.es.js","sources":["../src/parser/contexts/vc.ts","../src/parser/contexts/inrupt.ts","../src/parser/contexts/inrupt-vc.ts","../src/parser/contexts/data-integrity.ts","../src/parser/contexts/ed25519-2020.ts","../src/parser/contexts/revocation-list.ts","../src/parser/contexts/status-list.ts","../src/parser/contexts/index.ts","../src/parser/jsonld.ts","../src/common/constants.ts","../src/common/rdfjs.ts","../src/common/getters.ts","../src/common/isRdfjsVerifiableCredential.ts","../src/common/common.ts","../src/issue/issue.ts","../src/common/isRdfjsVerifiablePresentation.ts","../src/lookup/query.ts","../src/lookup/derive.ts","../src/revoke/revoke.ts","../src/verify/verify.ts"],"sourcesContent":["//\n// Copyright Inrupt Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to use,\n// copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n// Software, and to permit persons to whom the Software is furnished to do so,\n// subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n\n/**\n * The Verifiable Credentials context.\n * @see https://www.w3.org/2018/credentials/v1\n */\nexport default {\n  \"@context\": {\n    \"@version\": 1.1,\n    \"@protected\": true,\n    id: \"@id\",\n    type: \"@type\",\n    VerifiableCredential: {\n      \"@id\": \"https://www.w3.org/2018/credentials#VerifiableCredential\",\n      \"@context\": {\n        \"@version\": 1.1,\n        \"@protected\": true,\n        id: \"@id\",\n        type: \"@type\",\n        cred: \"https://www.w3.org/2018/credentials#\",\n        sec: \"https://w3id.org/security#\",\n        xsd: \"http://www.w3.org/2001/XMLSchema#\",\n        credentialSchema: {\n          \"@id\": \"cred:credentialSchema\",\n          \"@type\": \"@id\",\n          \"@context\": {\n            \"@version\": 1.1,\n            \"@protected\": true,\n            id: \"@id\",\n            type: \"@type\",\n            cred: \"https://www.w3.org/2018/credentials#\",\n            JsonSchemaValidator2018: \"cred:JsonSchemaValidator2018\",\n          },\n        },\n        credentialStatus: { \"@id\": \"cred:credentialStatus\", \"@type\": \"@id\" },\n        credentialSubject: { \"@id\": \"cred:credentialSubject\", \"@type\": \"@id\" },\n        evidence: { \"@id\": \"cred:evidence\", \"@type\": \"@id\" },\n        expirationDate: {\n          \"@id\": \"cred:expirationDate\",\n          \"@type\": \"xsd:dateTime\",\n        },\n        holder: { \"@id\": \"cred:holder\", \"@type\": \"@id\" },\n        issued: { \"@id\": \"cred:issued\", \"@type\": \"xsd:dateTime\" },\n        issuer: { \"@id\": \"cred:issuer\", \"@type\": \"@id\" },\n        issuanceDate: { \"@id\": \"cred:issuanceDate\", \"@type\": \"xsd:dateTime\" },\n        proof: { \"@id\": \"sec:proof\", \"@type\": \"@id\", \"@container\": \"@graph\" },\n        refreshService: {\n          \"@id\": \"cred:refreshService\",\n          \"@type\": \"@id\",\n          \"@context\": {\n            \"@version\": 1.1,\n            \"@protected\": true,\n            id: \"@id\",\n            type: \"@type\",\n            cred: \"https://www.w3.org/2018/credentials#\",\n            ManualRefreshService2018: \"cred:ManualRefreshService2018\",\n          },\n        },\n        termsOfUse: { \"@id\": \"cred:termsOfUse\", \"@type\": \"@id\" },\n        validFrom: { \"@id\": \"cred:validFrom\", \"@type\": \"xsd:dateTime\" },\n        validUntil: { \"@id\": \"cred:validUntil\", \"@type\": \"xsd:dateTime\" },\n      },\n    },\n    VerifiablePresentation: {\n      \"@id\": \"https://www.w3.org/2018/credentials#VerifiablePresentation\",\n      \"@context\": {\n        \"@version\": 1.1,\n        \"@protected\": true,\n        id: \"@id\",\n        type: \"@type\",\n        cred: \"https://www.w3.org/2018/credentials#\",\n        sec: \"https://w3id.org/security#\",\n        holder: { \"@id\": \"cred:holder\", \"@type\": \"@id\" },\n        proof: { \"@id\": \"sec:proof\", \"@type\": \"@id\", \"@container\": \"@graph\" },\n        verifiableCredential: {\n          \"@id\": \"cred:verifiableCredential\",\n          \"@type\": \"@id\",\n          \"@container\": \"@graph\",\n        },\n      },\n    },\n    EcdsaSecp256k1Signature2019: {\n      \"@id\": \"https://w3id.org/security#EcdsaSecp256k1Signature2019\",\n      \"@context\": {\n        \"@version\": 1.1,\n        \"@protected\": true,\n        id: \"@id\",\n        type: \"@type\",\n        sec: \"https://w3id.org/security#\",\n        xsd: \"http://www.w3.org/2001/XMLSchema#\",\n        challenge: \"sec:challenge\",\n        created: {\n          \"@id\": \"http://purl.org/dc/terms/created\",\n          \"@type\": \"xsd:dateTime\",\n        },\n        domain: \"sec:domain\",\n        expires: { \"@id\": \"sec:expiration\", \"@type\": \"xsd:dateTime\" },\n        jws: \"sec:jws\",\n        nonce: \"sec:nonce\",\n        proofPurpose: {\n          \"@id\": \"sec:proofPurpose\",\n          \"@type\": \"@vocab\",\n          \"@context\": {\n            \"@version\": 1.1,\n            \"@protected\": true,\n            id: \"@id\",\n            type: \"@type\",\n            sec: \"https://w3id.org/security#\",\n            assertionMethod: {\n              \"@id\": \"sec:assertionMethod\",\n              \"@type\": \"@id\",\n              \"@container\": \"@set\",\n            },\n            authentication: {\n              \"@id\": \"sec:authenticationMethod\",\n              \"@type\": \"@id\",\n              \"@container\": \"@set\",\n            },\n          },\n        },\n        proofValue: \"sec:proofValue\",\n        verificationMethod: { \"@id\": \"sec:verificationMethod\", \"@type\": \"@id\" },\n      },\n    },\n    EcdsaSecp256r1Signature2019: {\n      \"@id\": \"https://w3id.org/security#EcdsaSecp256r1Signature2019\",\n      \"@context\": {\n        \"@version\": 1.1,\n        \"@protected\": true,\n        id: \"@id\",\n        type: \"@type\",\n        sec: \"https://w3id.org/security#\",\n        xsd: \"http://www.w3.org/2001/XMLSchema#\",\n        challenge: \"sec:challenge\",\n        created: {\n          \"@id\": \"http://purl.org/dc/terms/created\",\n          \"@type\": \"xsd:dateTime\",\n        },\n        domain: \"sec:domain\",\n        expires: { \"@id\": \"sec:expiration\", \"@type\": \"xsd:dateTime\" },\n        jws: \"sec:jws\",\n        nonce: \"sec:nonce\",\n        proofPurpose: {\n          \"@id\": \"sec:proofPurpose\",\n          \"@type\": \"@vocab\",\n          \"@context\": {\n            \"@version\": 1.1,\n            \"@protected\": true,\n            id: \"@id\",\n            type: \"@type\",\n            sec: \"https://w3id.org/security#\",\n            assertionMethod: {\n              \"@id\": \"sec:assertionMethod\",\n              \"@type\": \"@id\",\n              \"@container\": \"@set\",\n            },\n            authentication: {\n              \"@id\": \"sec:authenticationMethod\",\n              \"@type\": \"@id\",\n              \"@container\": \"@set\",\n            },\n          },\n        },\n        proofValue: \"sec:proofValue\",\n        verificationMethod: { \"@id\": \"sec:verificationMethod\", \"@type\": \"@id\" },\n      },\n    },\n    Ed25519Signature2018: {\n      \"@id\": \"https://w3id.org/security#Ed25519Signature2018\",\n      \"@context\": {\n        \"@version\": 1.1,\n        \"@protected\": true,\n        id: \"@id\",\n        type: \"@type\",\n        sec: \"https://w3id.org/security#\",\n        xsd: \"http://www.w3.org/2001/XMLSchema#\",\n        challenge: \"sec:challenge\",\n        created: {\n          \"@id\": \"http://purl.org/dc/terms/created\",\n          \"@type\": \"xsd:dateTime\",\n        },\n        domain: \"sec:domain\",\n        expires: { \"@id\": \"sec:expiration\", \"@type\": \"xsd:dateTime\" },\n        jws: \"sec:jws\",\n        nonce: \"sec:nonce\",\n        proofPurpose: {\n          \"@id\": \"sec:proofPurpose\",\n          \"@type\": \"@vocab\",\n          \"@context\": {\n            \"@version\": 1.1,\n            \"@protected\": true,\n            id: \"@id\",\n            type: \"@type\",\n            sec: \"https://w3id.org/security#\",\n            assertionMethod: {\n              \"@id\": \"sec:assertionMethod\",\n              \"@type\": \"@id\",\n              \"@container\": \"@set\",\n            },\n            authentication: {\n              \"@id\": \"sec:authenticationMethod\",\n              \"@type\": \"@id\",\n              \"@container\": \"@set\",\n            },\n          },\n        },\n        proofValue: \"sec:proofValue\",\n        verificationMethod: { \"@id\": \"sec:verificationMethod\", \"@type\": \"@id\" },\n      },\n    },\n    RsaSignature2018: {\n      \"@id\": \"https://w3id.org/security#RsaSignature2018\",\n      \"@context\": {\n        \"@version\": 1.1,\n        \"@protected\": true,\n        challenge: \"sec:challenge\",\n        created: {\n          \"@id\": \"http://purl.org/dc/terms/created\",\n          \"@type\": \"xsd:dateTime\",\n        },\n        domain: \"sec:domain\",\n        expires: { \"@id\": \"sec:expiration\", \"@type\": \"xsd:dateTime\" },\n        jws: \"sec:jws\",\n        nonce: \"sec:nonce\",\n        proofPurpose: {\n          \"@id\": \"sec:proofPurpose\",\n          \"@type\": \"@vocab\",\n          \"@context\": {\n            \"@version\": 1.1,\n            \"@protected\": true,\n            id: \"@id\",\n            type: \"@type\",\n            sec: \"https://w3id.org/security#\",\n            assertionMethod: {\n              \"@id\": \"sec:assertionMethod\",\n              \"@type\": \"@id\",\n              \"@container\": \"@set\",\n            },\n            authentication: {\n              \"@id\": \"sec:authenticationMethod\",\n              \"@type\": \"@id\",\n              \"@container\": \"@set\",\n            },\n          },\n        },\n        proofValue: \"sec:proofValue\",\n        verificationMethod: { \"@id\": \"sec:verificationMethod\", \"@type\": \"@id\" },\n      },\n    },\n    proof: {\n      \"@id\": \"https://w3id.org/security#proof\",\n      \"@type\": \"@id\",\n      \"@container\": \"@graph\",\n    },\n  },\n} as const;\n","//\n// Copyright Inrupt Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to use,\n// copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n// Software, and to permit persons to whom the Software is furnished to do so,\n// subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n\n/**\n * The custom Inrupt context for verifiable credentials\n * @see https://schema.inrupt.com/credentials/v1.jsonld\n */\nexport default {\n  \"@context\": {\n    \"@version\": 1.1,\n    \"@protected\": true,\n    ldp: \"http://www.w3.org/ns/ldp#\",\n    acl: \"http://www.w3.org/ns/auth/acl#\",\n    gc: \"https://w3id.org/GConsent#\",\n    vc: \"http://www.w3.org/ns/solid/vc#\",\n    xsd: \"http://www.w3.org/2001/XMLSchema#\",\n    issuerService: {\n      \"@id\": \"vc:issuerService\",\n      \"@type\": \"@id\",\n    },\n    statusService: {\n      \"@id\": \"vc:statusService\",\n      \"@type\": \"@id\",\n    },\n    verifierService: {\n      \"@id\": \"vc:verifierService\",\n      \"@type\": \"@id\",\n    },\n    derivationService: {\n      \"@id\": \"vc:derivationService\",\n      \"@type\": \"@id\",\n    },\n    proofService: {\n      \"@id\": \"vc:proofService\",\n      \"@type\": \"@id\",\n    },\n    availabilityService: {\n      \"@id\": \"vc:availabilityService\",\n      \"@type\": \"@id\",\n    },\n    submissionService: {\n      \"@id\": \"vc:submissionService\",\n      \"@type\": \"@id\",\n    },\n    supportedSignatureTypes: {\n      \"@id\": \"vc:supportedSignatureTypes\",\n      \"@type\": \"@id\",\n    },\n    include: {\n      \"@id\": \"vc:include\",\n      \"@type\": \"@id\",\n    },\n    SolidAccessGrant: \"vc:SolidAccessGrant\",\n    SolidAccessRequest: \"vc:SolidAccessRequest\",\n    ExpiredVerifiableCredential: \"vc:ExpiredVerifiableCredential\",\n    inbox: {\n      \"@id\": \"ldp:inbox\",\n      \"@type\": \"@id\",\n    },\n    Read: \"acl:Read\",\n    Write: \"acl:Write\",\n    Append: \"acl:Append\",\n    mode: {\n      \"@id\": \"acl:mode\",\n      \"@type\": \"@vocab\",\n    },\n    Consent: \"gc:Consent\",\n    ConsentStatusExpired: \"gc:ConsentStatusExpired\",\n    ConsentStatusExplicitlyGiven: \"gc:ConsentStatusExplicitlyGiven\",\n    ConsentStatusGivenByDelegation: \"gc:ConsentStatusGivenByDelegation\",\n    ConsentStatusImplicitlyGiven: \"gc:ConsentStatusImplicitlyGiven\",\n    ConsentStatusInvalidated: \"gc:ConsentStatusInvalidated\",\n    ConsentStatusNotGiven: \"gc:ConsentStatusNotGiven\",\n    ConsentStatusRefused: \"gc:ConsentStatusRefused\",\n    ConsentStatusRequested: \"gc:ConsentStatusRequested\",\n    ConsentStatusUnknown: \"gc:ConsentStatusUnknown\",\n    ConsentStatusWithdrawn: \"gc:ConsentStatusWithdrawn\",\n    forPersonalData: {\n      \"@id\": \"gc:forPersonalData\",\n      \"@type\": \"@id\",\n    },\n    forProcessing: {\n      \"@id\": \"gc:forProcessing\",\n      \"@type\": \"@id\",\n    },\n    forPurpose: {\n      \"@id\": \"gc:forPurpose\",\n      \"@type\": \"@id\",\n    },\n    hasConsent: {\n      \"@id\": \"gc:hasConsent\",\n      \"@type\": \"@id\",\n    },\n    hasContext: {\n      \"@id\": \"gc:hasContext\",\n      \"@type\": \"@id\",\n    },\n    hasStatus: {\n      \"@id\": \"gc:hasStatus\",\n      \"@type\": \"@vocab\",\n    },\n    inMedium: {\n      \"@id\": \"gc:inMedium\",\n      \"@type\": \"@id\",\n    },\n    isConsentForDataSubject: {\n      \"@id\": \"gc:isConsentForDataSubject\",\n      \"@type\": \"@id\",\n    },\n    isProvidedTo: {\n      \"@id\": \"gc:isProvidedTo\",\n      \"@type\": \"@id\",\n    },\n    isProvidedToPerson: {\n      \"@id\": \"gc:isProvidedToPerson\",\n      \"@type\": \"@id\",\n    },\n    isProvidedToController: {\n      \"@id\": \"gc:isProvidedToController\",\n      \"@type\": \"@id\",\n    },\n    providedConsent: {\n      \"@id\": \"gc:providedConsent\",\n      \"@type\": \"@id\",\n    },\n    inherit: {\n      \"@id\": \"urn:uuid:71ab2f68-a68b-4452-b968-dd23e0570227\",\n      \"@type\": \"xsd:boolean\",\n    },\n  },\n} as const;\n","//\n// Copyright Inrupt Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to use,\n// copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n// Software, and to permit persons to whom the Software is furnished to do so,\n// subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n\n/**\n * @see https://vc.inrupt.com/credentials/v1\n */\nexport default {\n  \"@context\": {\n    \"@version\": 1.1,\n    \"@protected\": true,\n    ldp: \"http://www.w3.org/ns/ldp#\",\n    acl: \"http://www.w3.org/ns/auth/acl#\",\n    gc: \"https://w3id.org/GConsent#\",\n    vc: \"http://www.w3.org/ns/solid/vc#\",\n    xsd: \"http://www.w3.org/2001/XMLSchema#\",\n    issuerService: { \"@id\": \"vc:issuerService\", \"@type\": \"@id\" },\n    statusService: { \"@id\": \"vc:statusService\", \"@type\": \"@id\" },\n    verifierService: { \"@id\": \"vc:verifierService\", \"@type\": \"@id\" },\n    derivationService: { \"@id\": \"vc:derivationService\", \"@type\": \"@id\" },\n    proofService: { \"@id\": \"vc:proofService\", \"@type\": \"@id\" },\n    availabilityService: { \"@id\": \"vc:availabilityService\", \"@type\": \"@id\" },\n    submissionService: { \"@id\": \"vc:submissionService\", \"@type\": \"@id\" },\n    supportedSignatureTypes: {\n      \"@id\": \"vc:supportedSignatureTypes\",\n      \"@type\": \"@id\",\n    },\n    include: { \"@id\": \"vc:include\", \"@type\": \"@id\" },\n    SolidAccessGrant: \"vc:SolidAccessGrant\",\n    SolidAccessRequest: \"vc:SolidAccessRequest\",\n    ExpiredVerifiableCredential: \"vc:ExpiredVerifiableCredential\",\n    inbox: { \"@id\": \"ldp:inbox\", \"@type\": \"@id\" },\n    Read: \"acl:Read\",\n    Write: \"acl:Write\",\n    Append: \"acl:Append\",\n    mode: { \"@id\": \"acl:mode\", \"@type\": \"@vocab\" },\n    Consent: \"gc:Consent\",\n    ConsentStatusExpired: \"gc:ConsentStatusExpired\",\n    ConsentStatusExplicitlyGiven: \"gc:ConsentStatusExplicitlyGiven\",\n    ConsentStatusGivenByDelegation: \"gc:ConsentStatusGivenByDelegation\",\n    ConsentStatusImplicitlyGiven: \"gc:ConsentStatusImplicitlyGiven\",\n    ConsentStatusInvalidated: \"gc:ConsentStatusInvalidated\",\n    ConsentStatusNotGiven: \"gc:ConsentStatusNotGiven\",\n    ConsentStatusRefused: \"gc:ConsentStatusRefused\",\n    ConsentStatusRequested: \"gc:ConsentStatusRequested\",\n    ConsentStatusUnknown: \"gc:ConsentStatusUnknown\",\n    ConsentStatusWithdrawn: \"gc:ConsentStatusWithdrawn\",\n    forPersonalData: { \"@id\": \"gc:forPersonalData\", \"@type\": \"@id\" },\n    forProcessing: { \"@id\": \"gc:forProcessing\", \"@type\": \"@id\" },\n    forPurpose: { \"@id\": \"gc:forPurpose\", \"@type\": \"@id\" },\n    hasConsent: { \"@id\": \"gc:hasConsent\", \"@type\": \"@id\" },\n    hasContext: { \"@id\": \"gc:hasContext\", \"@type\": \"@id\" },\n    hasStatus: { \"@id\": \"gc:hasStatus\", \"@type\": \"@vocab\" },\n    inMedium: { \"@id\": \"gc:inMedium\", \"@type\": \"@id\" },\n    isConsentForDataSubject: {\n      \"@id\": \"gc:isConsentForDataSubject\",\n      \"@type\": \"@id\",\n    },\n    isProvidedTo: { \"@id\": \"gc:isProvidedTo\", \"@type\": \"@id\" },\n    isProvidedToPerson: { \"@id\": \"gc:isProvidedToPerson\", \"@type\": \"@id\" },\n    isProvidedToController: {\n      \"@id\": \"gc:isProvidedToController\",\n      \"@type\": \"@id\",\n    },\n    providedConsent: { \"@id\": \"gc:providedConsent\", \"@type\": \"@id\" },\n    inherit: {\n      \"@id\": \"urn:uuid:71ab2f68-a68b-4452-b968-dd23e0570227\",\n      \"@type\": \"xsd:boolean\",\n    },\n  },\n};\n","//\n// Copyright Inrupt Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to use,\n// copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n// Software, and to permit persons to whom the Software is furnished to do so,\n// subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n\n/**\n * @see https://w3id.org/security/data-integrity/v1\n */\nexport default {\n  \"@context\": {\n    id: \"@id\",\n    type: \"@type\",\n    \"@protected\": true,\n    proof: {\n      \"@id\": \"https://w3id.org/security#proof\",\n      \"@type\": \"@id\",\n      \"@container\": \"@graph\",\n    },\n    DataIntegrityProof: {\n      \"@id\": \"https://w3id.org/security#DataIntegrityProof\",\n      \"@context\": {\n        \"@protected\": true,\n        id: \"@id\",\n        type: \"@type\",\n        challenge: \"https://w3id.org/security#challenge\",\n        created: {\n          \"@id\": \"http://purl.org/dc/terms/created\",\n          \"@type\": \"http://www.w3.org/2001/XMLSchema#dateTime\",\n        },\n        domain: \"https://w3id.org/security#domain\",\n        expires: {\n          \"@id\": \"https://w3id.org/security#expiration\",\n          \"@type\": \"http://www.w3.org/2001/XMLSchema#dateTime\",\n        },\n        nonce: \"https://w3id.org/security#nonce\",\n        proofPurpose: {\n          \"@id\": \"https://w3id.org/security#proofPurpose\",\n          \"@type\": \"@vocab\",\n          \"@context\": {\n            \"@protected\": true,\n            id: \"@id\",\n            type: \"@type\",\n            assertionMethod: {\n              \"@id\": \"https://w3id.org/security#assertionMethod\",\n              \"@type\": \"@id\",\n              \"@container\": \"@set\",\n            },\n            authentication: {\n              \"@id\": \"https://w3id.org/security#authenticationMethod\",\n              \"@type\": \"@id\",\n              \"@container\": \"@set\",\n            },\n            capabilityInvocation: {\n              \"@id\": \"https://w3id.org/security#capabilityInvocationMethod\",\n              \"@type\": \"@id\",\n              \"@container\": \"@set\",\n            },\n            capabilityDelegation: {\n              \"@id\": \"https://w3id.org/security#capabilityDelegationMethod\",\n              \"@type\": \"@id\",\n              \"@container\": \"@set\",\n            },\n            keyAgreement: {\n              \"@id\": \"https://w3id.org/security#keyAgreementMethod\",\n              \"@type\": \"@id\",\n              \"@container\": \"@set\",\n            },\n          },\n        },\n        cryptosuite: \"https://w3id.org/security#cryptosuite\",\n        proofValue: {\n          \"@id\": \"https://w3id.org/security#proofValue\",\n          \"@type\": \"https://w3id.org/security#multibase\",\n        },\n        verificationMethod: {\n          \"@id\": \"https://w3id.org/security#verificationMethod\",\n          \"@type\": \"@id\",\n        },\n      },\n    },\n  },\n};\n","//\n// Copyright Inrupt Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to use,\n// copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n// Software, and to permit persons to whom the Software is furnished to do so,\n// subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n\n/**\n * @see https://w3id.org/security/suites/ed25519-2020/v1\n */\nexport default {\n  \"@context\": {\n    id: \"@id\",\n    type: \"@type\",\n    \"@protected\": true,\n    proof: {\n      \"@id\": \"https://w3id.org/security#proof\",\n      \"@type\": \"@id\",\n      \"@container\": \"@graph\",\n    },\n    Ed25519VerificationKey2020: {\n      \"@id\": \"https://w3id.org/security#Ed25519VerificationKey2020\",\n      \"@context\": {\n        \"@protected\": true,\n        id: \"@id\",\n        type: \"@type\",\n        controller: {\n          \"@id\": \"https://w3id.org/security#controller\",\n          \"@type\": \"@id\",\n        },\n        revoked: {\n          \"@id\": \"https://w3id.org/security#revoked\",\n          \"@type\": \"http://www.w3.org/2001/XMLSchema#dateTime\",\n        },\n        publicKeyMultibase: {\n          \"@id\": \"https://w3id.org/security#publicKeyMultibase\",\n          \"@type\": \"https://w3id.org/security#multibase\",\n        },\n      },\n    },\n    Ed25519Signature2020: {\n      \"@id\": \"https://w3id.org/security#Ed25519Signature2020\",\n      \"@context\": {\n        \"@protected\": true,\n        id: \"@id\",\n        type: \"@type\",\n        challenge: \"https://w3id.org/security#challenge\",\n        created: {\n          \"@id\": \"http://purl.org/dc/terms/created\",\n          \"@type\": \"http://www.w3.org/2001/XMLSchema#dateTime\",\n        },\n        domain: \"https://w3id.org/security#domain\",\n        expires: {\n          \"@id\": \"https://w3id.org/security#expiration\",\n          \"@type\": \"http://www.w3.org/2001/XMLSchema#dateTime\",\n        },\n        nonce: \"https://w3id.org/security#nonce\",\n        proofPurpose: {\n          \"@id\": \"https://w3id.org/security#proofPurpose\",\n          \"@type\": \"@vocab\",\n          \"@context\": {\n            \"@protected\": true,\n            id: \"@id\",\n            type: \"@type\",\n            assertionMethod: {\n              \"@id\": \"https://w3id.org/security#assertionMethod\",\n              \"@type\": \"@id\",\n              \"@container\": \"@set\",\n            },\n            authentication: {\n              \"@id\": \"https://w3id.org/security#authenticationMethod\",\n              \"@type\": \"@id\",\n              \"@container\": \"@set\",\n            },\n            capabilityInvocation: {\n              \"@id\": \"https://w3id.org/security#capabilityInvocationMethod\",\n              \"@type\": \"@id\",\n              \"@container\": \"@set\",\n            },\n            capabilityDelegation: {\n              \"@id\": \"https://w3id.org/security#capabilityDelegationMethod\",\n              \"@type\": \"@id\",\n              \"@container\": \"@set\",\n            },\n            keyAgreement: {\n              \"@id\": \"https://w3id.org/security#keyAgreementMethod\",\n              \"@type\": \"@id\",\n              \"@container\": \"@set\",\n            },\n          },\n        },\n        proofValue: {\n          \"@id\": \"https://w3id.org/security#proofValue\",\n          \"@type\": \"https://w3id.org/security#multibase\",\n        },\n        verificationMethod: {\n          \"@id\": \"https://w3id.org/security#verificationMethod\",\n          \"@type\": \"@id\",\n        },\n      },\n    },\n  },\n};\n","//\n// Copyright Inrupt Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to use,\n// copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n// Software, and to permit persons to whom the Software is furnished to do so,\n// subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n\n/**\n * @see https://w3id.org/vc-revocation-list-2020/v1\n */\nexport default {\n  \"@context\": {\n    \"@protected\": true,\n    RevocationList2020Credential: {\n      \"@id\":\n        \"https://w3id.org/vc-revocation-list-2020#RevocationList2020Credential\",\n      \"@context\": {\n        \"@protected\": true,\n\n        id: \"@id\",\n        type: \"@type\",\n\n        description: \"http://schema.org/description\",\n        name: \"http://schema.org/name\",\n      },\n    },\n    RevocationList2020: {\n      \"@id\": \"https://w3id.org/vc-revocation-list-2020#RevocationList2020\",\n      \"@context\": {\n        \"@protected\": true,\n\n        id: \"@id\",\n        type: \"@type\",\n\n        encodedList: \"https://w3id.org/vc-revocation-list-2020#encodedList\",\n      },\n    },\n\n    RevocationList2020Status: {\n      \"@id\":\n        \"https://w3id.org/vc-revocation-list-2020#RevocationList2020Status\",\n      \"@context\": {\n        \"@protected\": true,\n\n        id: \"@id\",\n        type: \"@type\",\n\n        revocationListCredential: {\n          \"@id\":\n            \"https://w3id.org/vc-revocation-list-2020#revocationListCredential\",\n          \"@type\": \"@id\",\n        },\n        revocationListIndex:\n          \"https://w3id.org/vc-revocation-list-2020#revocationListIndex\",\n      },\n    },\n  },\n};\n","//\n// Copyright Inrupt Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to use,\n// copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n// Software, and to permit persons to whom the Software is furnished to do so,\n// subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n\n/**\n * @see https://w3id.org/vc/status-list/2021/v1\n */\nexport default {\n  \"@context\": {\n    \"@protected\": true,\n\n    StatusList2021Credential: {\n      \"@id\": \"https://w3id.org/vc/status-list#StatusList2021Credential\",\n      \"@context\": {\n        \"@protected\": true,\n\n        id: \"@id\",\n        type: \"@type\",\n\n        description: \"http://schema.org/description\",\n        name: \"http://schema.org/name\",\n      },\n    },\n\n    StatusList2021: {\n      \"@id\": \"https://w3id.org/vc/status-list#StatusList2021\",\n      \"@context\": {\n        \"@protected\": true,\n\n        id: \"@id\",\n        type: \"@type\",\n\n        statusPurpose: \"https://w3id.org/vc/status-list#statusPurpose\",\n        encodedList: \"https://w3id.org/vc/status-list#encodedList\",\n      },\n    },\n\n    StatusList2021Entry: {\n      \"@id\": \"https://w3id.org/vc/status-list#StatusList2021Entry\",\n      \"@context\": {\n        \"@protected\": true,\n\n        id: \"@id\",\n        type: \"@type\",\n\n        statusPurpose: \"https://w3id.org/vc/status-list#statusPurpose\",\n        statusListIndex: \"https://w3id.org/vc/status-list#statusListIndex\",\n        statusListCredential: {\n          \"@id\": \"https://w3id.org/vc/status-list#statusListCredential\",\n          \"@type\": \"@id\",\n        },\n      },\n    },\n  },\n};\n","//\n// Copyright Inrupt Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to use,\n// copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n// Software, and to permit persons to whom the Software is furnished to do so,\n// subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\nimport VC from \"./vc\";\nimport Inrupt from \"./inrupt\";\nimport vc from \"./inrupt-vc\";\nimport integrity from \"./data-integrity\";\nimport ed25519 from \"./ed25519-2020\";\nimport revocation from \"./revocation-list\";\nimport statusList from \"./status-list\";\n\nconst contextDefinitions = {\n  \"https://www.w3.org/2018/credentials/v1\": VC,\n  \"https://schema.inrupt.com/credentials/v1.jsonld\": Inrupt,\n} as const;\n\nexport const cachedContexts = {\n  \"https://vc.inrupt.com/credentials/v1\": vc,\n  \"https://w3id.org/security/data-integrity/v1\": integrity,\n  \"https://w3id.org/vc-revocation-list-2020/v1\": revocation,\n  \"https://w3id.org/vc/status-list/2021/v1\": statusList,\n  \"https://w3id.org/security/suites/ed25519-2020/v1\": ed25519,\n};\n\nexport const context = Object.keys(contextDefinitions);\nexport default contextDefinitions;\n","//\n// Copyright Inrupt Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to use,\n// copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n// Software, and to permit persons to whom the Software is furnished to do so,\n// subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n\n/* eslint-disable max-classes-per-file */\nimport { promisifyEventEmitter } from \"event-emitter-promisify\";\nimport type {\n  IJsonLdContext,\n  IParseOptions,\n  JsonLdContext,\n  JsonLdContextNormalized,\n} from \"jsonld-context-parser\";\nimport { ContextParser, FetchDocumentLoader } from \"jsonld-context-parser\";\nimport { JsonLdParser } from \"jsonld-streaming-parser\";\nimport { Store } from \"n3\";\nimport md5 from \"md5\";\nimport type { JsonLd } from \"../common/common\";\nimport CONTEXTS, { cachedContexts } from \"./contexts\";\n\n/**\n * A JSON-LD document loader with the standard context for VCs pre-loaded\n */\nexport class CachedFetchDocumentLoader extends FetchDocumentLoader {\n  private contexts: Record<string, JsonLd>;\n\n  constructor(\n    contexts?: Record<string, JsonLd>,\n    private readonly allowContextFetching = false,\n    ...args: ConstructorParameters<typeof FetchDocumentLoader>\n  ) {\n    super(args[0] ?? fetch);\n    this.contexts = { ...contexts, ...cachedContexts, ...CONTEXTS };\n  }\n\n  public async load(url: string): Promise<IJsonLdContext> {\n    if (Object.keys(this.contexts).includes(url)) {\n      return this.contexts[url as keyof typeof CONTEXTS];\n    }\n    if (!this.allowContextFetching) {\n      throw new Error(`Unexpected context requested [${url}]`);\n    }\n    return super.load(url);\n  }\n}\n\nexport interface ParseOptions {\n  baseIRI?: string;\n  contexts?: Record<string, JsonLd>;\n  allowContextFetching?: boolean;\n}\n\nfunction hashOptions(options: IParseOptions | undefined) {\n  const opts = { ...options, parentContext: undefined };\n  for (const key of Object.keys(opts)) {\n    if (typeof opts[key as keyof typeof opts] === \"undefined\") {\n      delete opts[key as keyof typeof opts];\n    }\n  }\n\n  return md5(JSON.stringify(opts, Object.keys(opts).sort()));\n}\n\nfunction hashContext(\n  context: JsonLdContext,\n  cmap: (c: IJsonLdContext) => number,\n): string {\n  if (Array.isArray(context)) {\n    return md5(\n      JSON.stringify(context.map((c) => (typeof c === \"string\" ? c : cmap(c)))),\n    );\n  }\n  return typeof context === \"string\" ? md5(context) : cmap(context).toString();\n}\n\n// This is a workaround until https://github.com/rubensworks/jsonld-context-parser.js/pull/70 is closed\nexport class CachingContextParser extends ContextParser {\n  private cachedParsing: Record<string, Promise<JsonLdContextNormalized>> = {};\n\n  private contextMap: Map<IJsonLdContext, number> = new Map();\n\n  private contextHashMap: Map<string, number> = new Map();\n\n  private mapIndex = 1;\n\n  private cmap = (context: IJsonLdContext) => {\n    if (!this.contextMap.has(context)) {\n      const hash = md5(JSON.stringify(context));\n      if (!this.contextHashMap.has(hash)) {\n        this.contextHashMap.set(hash, (this.mapIndex += 1));\n      }\n      this.contextMap.set(context, this.contextHashMap.get(hash)!);\n    }\n    return this.contextMap.get(context)!;\n  };\n\n  async parse(\n    context: JsonLdContext,\n    options?: IParseOptions,\n  ): Promise<JsonLdContextNormalized> {\n    let hash = hashOptions(options);\n\n    if (\n      options?.parentContext &&\n      Object.keys(options.parentContext).length !== 0\n    ) {\n      hash = md5(hash + this.cmap(options.parentContext));\n    }\n\n    // eslint-disable-next-line no-return-assign\n    return (this.cachedParsing[md5(hash + hashContext(context, this.cmap))] ??=\n      super.parse(context, options));\n  }\n}\n\nlet reusableDocumentLoader: CachedFetchDocumentLoader;\nlet reusableContextParser: CachingContextParser;\n\n/**\n * Our internal JsonLd Parser with a cached VC context\n */\nexport class CachedJsonLdParser extends JsonLdParser {\n  constructor(options?: ParseOptions) {\n    let documentLoader: CachedFetchDocumentLoader;\n\n    if (!options?.contexts && !options?.allowContextFetching) {\n      reusableDocumentLoader ??= new CachedFetchDocumentLoader(\n        undefined,\n        undefined,\n        fetch,\n      );\n      documentLoader = reusableDocumentLoader;\n    } else {\n      documentLoader = new CachedFetchDocumentLoader(\n        options.contexts,\n        options.allowContextFetching,\n        fetch,\n      );\n    }\n\n    super({\n      documentLoader,\n      baseIRI: options?.baseIRI,\n    });\n\n    if (!options?.contexts && !options?.allowContextFetching) {\n      reusableContextParser ??= new CachingContextParser({\n        documentLoader: reusableDocumentLoader,\n      });\n      // @ts-expect-error parsingContext is an internal property\n      this.parsingContext.contextParser = reusableContextParser;\n    }\n  }\n}\n\n/**\n * Gets an N3 store from a JSON-LD string\n * @param response A JSON-LD string\n * @param options An optional fetch function for dereferencing remote contexts\n * @returns A store containing the Quads in the JSON-LD response\n */\nexport async function jsonLdStringToStore(\n  data: string,\n  options?: ParseOptions,\n) {\n  const parser = new CachedJsonLdParser(options);\n  const store = new Store();\n  const storePromise = promisifyEventEmitter(store.import(parser), store);\n  parser.write(data);\n  parser.end();\n  return storePromise;\n}\n\n/**\n * Gets an N3 store from a JSON-LD as an Object\n * @param response JSON-LD as an Object\n * @param options An optional fetch function for dereferencing remote contexts\n * @returns A store containing the Quads in the JSON-LD response\n */\nexport function jsonLdToStore(data: unknown, options?: ParseOptions) {\n  return jsonLdStringToStore(JSON.stringify(data), options);\n}\n","//\n// Copyright Inrupt Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to use,\n// copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n// Software, and to permit persons to whom the Software is furnished to do so,\n// subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\nimport { DataFactory } from \"n3\";\nimport { rdf as _rdf } from \"rdf-namespaces\";\n\nconst { namedNode } = DataFactory;\n\nconst SEC = \"https://w3id.org/security#\";\nconst CRED = \"https://www.w3.org/2018/credentials#\";\nconst XSD = \"http://www.w3.org/2001/XMLSchema#\";\nconst DC = \"http://purl.org/dc/terms/\";\n\nexport const rdf = {\n  type: namedNode(_rdf.type),\n};\n\nexport const xsd = {\n  boolean: namedNode(`${XSD}boolean`),\n  dateTime: namedNode(`${XSD}dateTime`),\n};\n\nexport const cred = {\n  issuanceDate: namedNode(`${CRED}issuanceDate`),\n  expirationDate: namedNode(`${CRED}expirationDate`),\n  issuer: namedNode(`${CRED}issuer`),\n  credentialSubject: namedNode(`${CRED}credentialSubject`),\n  verifiableCredential: namedNode(`${CRED}verifiableCredential`),\n  holder: namedNode(`${CRED}holder`),\n  VerifiableCredential: namedNode(`${CRED}VerifiableCredential`),\n  VerifiablePresentation: namedNode(`${CRED}VerifiablePresentation`),\n};\nexport const sec = {\n  proof: namedNode(`${SEC}proof`),\n  proofPurpose: namedNode(`${SEC}proofPurpose`),\n  proofValue: namedNode(`${SEC}proofValue`),\n  verificationMethod: namedNode(`${SEC}verificationMethod`),\n};\n\nexport const dc = {\n  created: namedNode(`${DC}created`),\n};\n","//\n// Copyright Inrupt Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to use,\n// copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n// Software, and to permit persons to whom the Software is furnished to do so,\n// subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\nimport type { DatasetCore, Term } from \"@rdfjs/types\";\nimport { DataFactory } from \"n3\";\n\nconst { defaultGraph } = DataFactory;\n\n/**\n * @internal\n */\nexport function getSingleObject<T extends Term>(\n  vc: DatasetCore,\n  subject: Term,\n  predicate: Term,\n  type: Term[\"termType\"],\n): T;\nexport function getSingleObject<T extends Term>(\n  vc: DatasetCore,\n  subject: Term,\n  predicate: Term,\n  type?: T[\"termType\"],\n): T {\n  const results = [...vc.match(subject, predicate, null, defaultGraph())];\n\n  if (results.length !== 1) {\n    throw new Error(`Expected exactly one result. Found ${results.length}.`);\n  }\n\n  const [{ object }] = results;\n  const expectedTypes = [type];\n  if (!expectedTypes.includes(object.termType)) {\n    throw new Error(\n      `Expected [${object.value}] to be a ${expectedTypes.join(\n        \" or \",\n      )}. Found [${object.termType}]`,\n    );\n  }\n\n  return object as T;\n}\n\n/**\n * @internal\n */\nexport function lenientSingle<T extends Term>(\n  dataset: DatasetCore,\n  termTypes: T[\"termType\"][] = [\"NamedNode\", \"BlankNode\"],\n): T | undefined {\n  const array = [...dataset];\n  return array.length === 1 && termTypes.includes(array[0].object.termType)\n    ? (array[0].object as T)\n    : undefined;\n}\n","//\n// Copyright Inrupt Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to use,\n// copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n// Software, and to permit persons to whom the Software is furnished to do so,\n// subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\nimport type { BlankNode, DatasetCore, Literal, NamedNode } from \"@rdfjs/types\";\nimport { DataFactory } from \"n3\";\nimport { type DatasetWithId } from \"./common\";\nimport { cred, dc, rdf, sec, xsd } from \"./constants\";\nimport { getSingleObject, lenientSingle } from \"./rdfjs\";\n\nconst { namedNode, defaultGraph } = DataFactory;\n\n/**\n * Get the ID (URL) of a Verifiable Credential.\n *\n * @example\n *\n * ```\n * const id = getId(vc);\n * ```\n *\n * @param vc The Verifiable Credential\n * @returns The VC ID URL\n */\nexport function getId(vc: DatasetWithId): string {\n  return vc.id;\n}\n\n/**\n * Get the subject of a Verifiable Credential.\n *\n * @example\n *\n * ```\n * const subject = getCredentialSubject(vc);\n * ```\n *\n * @param vc The Verifiable Credential\n * @returns The VC subject\n */\nexport function getCredentialSubject(vc: DatasetWithId): NamedNode {\n  return getSingleObject<NamedNode>(\n    vc,\n    namedNode(getId(vc)),\n    cred.credentialSubject,\n    \"NamedNode\",\n  );\n}\n\n/**\n * Get the issuer of a Verifiable Credential.\n *\n * @example\n *\n * ```\n * const issuer = getIssuer(vc);\n * ```\n *\n * @param vc The Verifiable Credential\n * @returns The VC issuer\n */\nexport function getIssuer(vc: DatasetWithId): string {\n  return getSingleObject(vc, namedNode(getId(vc)), cred.issuer, \"NamedNode\")\n    .value;\n}\n\n/**\n * @internal\n */\nfunction wrapDate(date: Literal) {\n  if (\n    !date.datatype.equals(\n      namedNode(\"http://www.w3.org/2001/XMLSchema#dateTime\"),\n    )\n  ) {\n    throw new Error(\n      `Expected date to be a dateTime; recieved [${date.datatype.value}]`,\n    );\n  }\n  if (Number.isNaN(Date.parse(date.value))) {\n    throw new Error(`Found invalid value for date: [${date.value}]`);\n  }\n  return new Date(date.value);\n}\n\n/**\n * Get the issuance date of a Verifiable Credential.\n *\n * @example\n *\n * ```\n * const date = getIssuanceDate(vc);\n * ```\n *\n * @param vc The Verifiable Credential\n * @returns The issuance date\n */\nexport function getIssuanceDate(vc: DatasetWithId): Date {\n  return wrapDate(\n    getSingleObject(vc, namedNode(getId(vc)), cred.issuanceDate, \"Literal\"),\n  );\n}\n\n/**\n * Get the expiration date of a Verifiable Credential.\n *\n * @example\n *\n * ```\n * const date = getExpirationDate(vc);\n * ```\n *\n * @param vc The Verifiable Credential\n * @returns The expiration date, or undefined if none is found.\n */\nexport function getExpirationDate(vc: DatasetWithId): Date | undefined {\n  const res = [\n    ...vc.match(\n      namedNode(getId(vc)),\n      cred.expirationDate,\n      undefined,\n      defaultGraph(),\n    ),\n  ];\n\n  if (res.length === 0) return undefined;\n\n  if (res.length !== 1)\n    throw new Error(`Expected 0 or 1 expiration date. Found ${res.length}.`);\n\n  if (res[0].object.termType !== \"Literal\")\n    throw new Error(\n      `Expected expiration date to be a Literal. Found [${res[0].object.value}] of type [${res[0].object.termType}].`,\n    );\n\n  return wrapDate(res[0].object);\n}\n\n/**\n * @internal\n */\nexport function isDate(literal?: Literal): boolean {\n  return (\n    !!literal &&\n    literal.datatype.equals(xsd.dateTime) &&\n    !Number.isNaN(Date.parse(literal.value))\n  );\n}\n\nexport function isValidProof(\n  dataset: DatasetCore,\n  proof: NamedNode | BlankNode,\n): boolean {\n  return (\n    isDate(\n      lenientSingle<Literal>(dataset.match(null, dc.created, null, proof), [\n        \"Literal\",\n      ]),\n    ) &&\n    lenientSingle<Literal>(dataset.match(null, sec.proofValue, null, proof), [\n      \"Literal\",\n    ]) !== undefined &&\n    lenientSingle<NamedNode>(\n      dataset.match(null, sec.proofPurpose, null, proof),\n      [\"NamedNode\"],\n    ) !== undefined &&\n    lenientSingle<NamedNode>(\n      dataset.match(null, sec.verificationMethod, null, proof),\n      [\"NamedNode\"],\n    ) !== undefined &&\n    lenientSingle<NamedNode>(dataset.match(null, rdf.type, null, proof), [\n      \"NamedNode\",\n    ]) !== undefined\n  );\n}\n","//\n// Copyright Inrupt Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to use,\n// copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n// Software, and to permit persons to whom the Software is furnished to do so,\n// subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\nimport type { BlankNode, DatasetCore, Literal, NamedNode } from \"@rdfjs/types\";\nimport { DataFactory } from \"n3\";\nimport { cred, rdf, sec } from \"./constants\";\nimport { lenientSingle } from \"./rdfjs\";\nimport { isValidProof, isDate } from \"./getters\";\n\nconst { defaultGraph, quad } = DataFactory;\n\n/**\n * Verifies that a given JSON-LD payload conforms to the Verifiable Credential\n * schema we expect.\n * @param data The JSON-LD payload as an RDFJS dataset\n * @param id The id of the VerifiableCredential as a Named Node\n * @returns true is the payload matches our expectation.\n * @deprecated Use isRdfjsVerifiableCredential instead\n */\nexport default function isRdfjsVerifiableCredential(\n  dataset: DatasetCore,\n  id: NamedNode,\n): boolean {\n  const proof = lenientSingle<NamedNode | BlankNode>(\n    dataset.match(id, sec.proof, null, defaultGraph()),\n  );\n  return (\n    !!proof &&\n    isValidProof(dataset, proof) &&\n    !!lenientSingle<NamedNode>(\n      dataset.match(id, cred.issuer, null, defaultGraph()),\n      [\"NamedNode\"],\n    ) &&\n    isDate(\n      lenientSingle<Literal>(\n        dataset.match(id, cred.issuanceDate, null, defaultGraph()),\n        [\"Literal\"],\n      ),\n    ) &&\n    !!lenientSingle<NamedNode>(\n      dataset.match(id, cred.credentialSubject, null, defaultGraph()),\n      [\"NamedNode\"],\n    ) &&\n    dataset.has(quad(id, rdf.type, cred.VerifiableCredential, defaultGraph()))\n  );\n}\n","//\n// Copyright Inrupt Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to use,\n// copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n// Software, and to permit persons to whom the Software is furnished to do so,\n// subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n\n/**\n * @module common\n */\n\nimport type { UrlString } from \"@inrupt/solid-client\";\nimport {\n  getIri,\n  getJsonLdParser,\n  getSolidDataset,\n  getThingAll,\n} from \"@inrupt/solid-client\";\nimport type { DatasetCore, Quad } from \"@rdfjs/types\";\nimport { DataFactory } from \"n3\";\nimport type { ParseOptions } from \"../parser/jsonld\";\nimport { jsonLdToStore } from \"../parser/jsonld\";\nimport isRdfjsVerifiableCredential from \"./isRdfjsVerifiableCredential\";\n\nconst { namedNode } = DataFactory;\n\nexport type DatasetWithId = DatasetCore & { id: string };\n\nexport type Iri = string;\n/**\n * A JSON-LD document is a JSON document including an @context entry. The other\n * fields may contain any value.\n * @deprecated Use RDFJS API instead\n */\nexport type JsonLd = {\n  \"@context\": unknown;\n  [property: string]: unknown;\n};\n\n/**\n * @deprecated Use RDFJS API instead\n */\ntype Proof = {\n  /**\n   * @deprecated Use RDFJS API instead\n   */\n  type: string;\n  /**\n   * ISO-8601 formatted date\n   */\n  created: string;\n  /**\n   * @deprecated Use RDFJS API instead\n   */\n  verificationMethod: string;\n  /**\n   * @deprecated Use RDFJS API instead\n   */\n  proofPurpose: string;\n  /**\n   * @deprecated Use RDFJS API instead\n   */\n  proofValue: string;\n};\n\n/**\n * A Verifiable Credential JSON-LD document, as specified by the W3C VC HTTP API.\n * @deprecated Use RDFJS API instead\n */\nexport type VerifiableCredentialBase = JsonLd & {\n  id: Iri;\n  /**\n   * @deprecated Use RDFJS API instead\n   */\n  type: Iri[];\n  /**\n   * @deprecated Use RDFJS API instead\n   */\n  issuer: Iri;\n  /**\n   * ISO-8601 formatted date\n   * @deprecated Use RDFJS API instead\n   */\n  issuanceDate: string;\n  /**\n   * Entity the credential makes claim about.\n   * @deprecated Use RDFJS API instead\n   */\n  credentialSubject: {\n    /**\n     * @deprecated Use RDFJS API instead\n     */\n    id: Iri;\n    /**\n     * The claim set is open, as any RDF graph is suitable for a set of claims.\n     * @deprecated Use RDFJS API instead\n     */\n    [property: string]: unknown;\n  };\n  /**\n   * @deprecated Use RDFJS API instead\n   */\n  proof: Proof;\n};\n\nexport type VerifiableCredential = VerifiableCredentialBase & DatasetCore;\n\nexport type VerifiablePresentation = JsonLd & {\n  id?: string;\n  type: string | string[];\n  verifiableCredential?: VerifiableCredentialBase[];\n  holder?: string;\n  proof?: Proof;\n};\n\nfunction isUnknownObject(x: unknown): x is {\n  [key in PropertyKey]: unknown;\n} {\n  return x !== null && typeof x === \"object\";\n}\n\nfunction hasProof(x: { [key in PropertyKey]: unknown }): x is {\n  proof: { [key in PropertyKey]: unknown };\n} {\n  return x.proof !== null && typeof x.proof === \"object\";\n}\n\n/**\n * This function is a temporary stopgap until we implement proper JSON-LD parsing.\n * It refactors know misalignments between the JSON-LD object we receive and the\n * JSON frame we expect.\n *\n * @param vcJson A JSON-LD VC.\n * @returns an equivalent JSON-LD VC, fitted to a specific frame.\n */\nexport function normalizeVc<T>(vcJson: T): T {\n  if (!isUnknownObject(vcJson) || !hasProof(vcJson)) {\n    // The received JSON doesn't have the shape we want to refactor\n    return vcJson;\n  }\n  const normalized = { ...vcJson };\n  if (\n    typeof vcJson.proof[\"https://w3id.org/security#proofValue\"] === \"string\"\n  ) {\n    normalized.proof.proofValue =\n      vcJson.proof[\"https://w3id.org/security#proofValue\"];\n    delete normalized.proof[\"https://w3id.org/security#proofValue\"];\n  }\n  return normalized;\n}\n\nfunction hasCredentials(x: { [key in PropertyKey]: unknown }): x is {\n  verifiableCredential: unknown[];\n} {\n  return (\n    x.verifiableCredential !== null && Array.isArray(x.verifiableCredential)\n  );\n}\n\n/**\n * Normalizes all VCs wrapped in a VP.\n *\n * @param vpJson A JSON-LD VP.\n * @returns An equivalent JSON-LD VP, with its contained VCs fitted to a specific frame.\n */\nexport function normalizeVp<T>(vpJson: T): T {\n  if (!isUnknownObject(vpJson) || !hasCredentials(vpJson)) {\n    // The received JSON doesn't have the shape we want to refactor\n    return vpJson;\n  }\n  const normalizedVp = { ...vpJson };\n  normalizedVp.verifiableCredential =\n    normalizedVp.verifiableCredential.map(normalizeVc);\n\n  return normalizedVp;\n}\n\n/**\n * Verifies that a given JSON-LD payload conforms to the Verifiable Credential\n * schema we expect.\n * @param data The JSON-LD payload\n * @returns true is the payload matches our expectation.\n * @deprecated Use isRdfjsVerifiableCredential instead\n */\nexport function isVerifiableCredential(\n  data: unknown | VerifiableCredentialBase,\n): data is VerifiableCredentialBase {\n  let dataIsVc = true;\n  dataIsVc = typeof (data as VerifiableCredentialBase).id === \"string\";\n  dataIsVc = dataIsVc && Array.isArray((data as VerifiableCredentialBase).type);\n  dataIsVc =\n    dataIsVc && typeof (data as VerifiableCredentialBase).issuer === \"string\";\n  dataIsVc =\n    dataIsVc &&\n    typeof (data as VerifiableCredentialBase).issuanceDate === \"string\";\n  dataIsVc =\n    dataIsVc &&\n    !Number.isNaN(Date.parse((data as VerifiableCredentialBase).issuanceDate));\n  dataIsVc =\n    dataIsVc &&\n    typeof (data as VerifiableCredentialBase).credentialSubject === \"object\";\n  dataIsVc =\n    dataIsVc &&\n    typeof (data as VerifiableCredentialBase).credentialSubject.id === \"string\";\n  dataIsVc =\n    dataIsVc && typeof (data as VerifiableCredentialBase).proof === \"object\";\n  dataIsVc =\n    dataIsVc &&\n    typeof (data as VerifiableCredentialBase).proof.created === \"string\";\n  dataIsVc =\n    dataIsVc &&\n    !Number.isNaN(Date.parse((data as VerifiableCredentialBase).proof.created));\n  dataIsVc =\n    dataIsVc &&\n    typeof (data as VerifiableCredentialBase).proof.proofPurpose === \"string\";\n  dataIsVc =\n    dataIsVc &&\n    typeof (data as VerifiableCredentialBase).proof.proofValue === \"string\";\n  dataIsVc =\n    dataIsVc &&\n    typeof (data as VerifiableCredentialBase).proof.type === \"string\";\n  dataIsVc =\n    dataIsVc &&\n    typeof (data as VerifiableCredentialBase).proof.verificationMethod ===\n      \"string\";\n  return dataIsVc;\n}\n\nexport function isUrl(url: string): boolean {\n  try {\n    // If url is not URL-shaped, this will throw.\n    // eslint-disable-next-line no-new\n    new URL(url);\n    return true;\n  } catch (_e) {\n    return false;\n  }\n}\n\n/**\n * @deprecated Use isRdfjsVerifiableCredential instead\n */\nexport function isVerifiablePresentation(\n  vp: unknown | VerifiablePresentation,\n): vp is VerifiablePresentation {\n  let inputIsVp = true;\n  inputIsVp =\n    inputIsVp &&\n    (Array.isArray((vp as VerifiablePresentation).type) ||\n      typeof (vp as VerifiablePresentation).type === \"string\");\n  if ((vp as VerifiablePresentation).verifiableCredential !== undefined) {\n    inputIsVp =\n      inputIsVp &&\n      Array.isArray((vp as VerifiablePresentation).verifiableCredential);\n    inputIsVp =\n      inputIsVp &&\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      (vp as VerifiablePresentation).verifiableCredential!.every(\n        isVerifiableCredential,\n      );\n  }\n  if ((vp as VerifiablePresentation).holder !== undefined) {\n    inputIsVp =\n      inputIsVp && typeof (vp as VerifiablePresentation).holder === \"string\";\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    inputIsVp = inputIsVp && isUrl((vp as VerifiablePresentation).holder!);\n  }\n  // TODO: No type checking is currently implemented for the proof.\n  return inputIsVp;\n}\n\nexport function concatenateContexts(...contexts: unknown[]): unknown {\n  const result: Set<unknown> = new Set();\n  contexts.forEach((additionalContext) => {\n    // Case when the context is an array of IRIs and/or inline contexts\n    if (Array.isArray(additionalContext)) {\n      additionalContext.forEach((contextEntry) => result.add(contextEntry));\n    } else if (additionalContext !== null && additionalContext !== undefined) {\n      // Case when the context is a single remote URI or a single inline context\n      result.add(additionalContext);\n    }\n  });\n  return Array.from(result.values());\n}\n\n/**\n * This context contains the required elements to build a valid VC issuance request.\n */\nexport const defaultContext = [\"https://www.w3.org/2018/credentials/v1\"];\n\nexport const defaultCredentialTypes = [\"VerifiableCredential\"];\n\n/**\n * A Verifiable Credential API configuration details.\n */\nexport type VerifiableCredentialApiConfiguration =\n  // Legacy endpoints\n  Partial<{\n    derivationService: UrlString;\n    issuerService: UrlString;\n    statusService: UrlString;\n    verifierService: UrlString;\n  }> & {\n    // Spec-compliant endpoints, available in the `specCompliant` object\n    specCompliant: Partial<{\n      derivationService: UrlString;\n      issuerService: UrlString;\n      issuerCredentialAll: UrlString;\n      holderPresentationAll: UrlString;\n      statusService: UrlString;\n      credentialVerifierService: UrlString;\n      presentationVerifierService: UrlString;\n      queryService: UrlString;\n      exchangeService: UrlString;\n      proveService: UrlString;\n    }>;\n  } & {\n    // Legacy endpoints, available in the `legacy` object too to ease transition\n    legacy: Partial<{\n      derivationService: UrlString;\n      issuerService: UrlString;\n      statusService: UrlString;\n      verifierService: UrlString;\n    }>;\n  };\n\n// Solid VC URIs\nconst SOLID_VC_NS = \"http://www.w3.org/ns/solid/vc#\";\nconst SOLID_VC_DERIVATION_SERVICE = SOLID_VC_NS.concat(\"derivationService\");\nconst SOLID_VC_ISSUER_SERVICE = SOLID_VC_NS.concat(\"issuerService\");\nconst SOLID_VC_STATUS_SERVICE = SOLID_VC_NS.concat(\"statusService\");\nconst SOLID_VC_VERIFIER_SERVICE = SOLID_VC_NS.concat(\"verifierService\");\n\nasync function discoverLegacyEndpoints(\n  vcServiceUrl: UrlString,\n): Promise<VerifiableCredentialApiConfiguration[\"legacy\"]> {\n  const wellKnownIri = new URL(\".well-known/vc-configuration\", vcServiceUrl);\n\n  try {\n    const vcConfigData = await getSolidDataset(wellKnownIri.href, {\n      // The configuration discovery document is only available as JSON-LD.\n      parsers: { \"application/ld+json\": getJsonLdParser() },\n    });\n\n    // The dataset should have a single blank node subject of all its triples.\n    const [wellKnownRootBlankNode] = getThingAll(vcConfigData, {\n      acceptBlankNodes: true,\n    });\n\n    return {\n      derivationService:\n        getIri(wellKnownRootBlankNode, SOLID_VC_DERIVATION_SERVICE) ??\n        undefined,\n      issuerService:\n        getIri(wellKnownRootBlankNode, SOLID_VC_ISSUER_SERVICE) ?? undefined,\n      statusService:\n        getIri(wellKnownRootBlankNode, SOLID_VC_STATUS_SERVICE) ?? undefined,\n      verifierService:\n        getIri(wellKnownRootBlankNode, SOLID_VC_VERIFIER_SERVICE) ?? undefined,\n    };\n  } catch (e) {\n    // The target provider may not implement the legacy endpoints, in which case\n    // the request above would fail.\n    return {};\n  }\n}\n\nfunction discoverSpecCompliantEndpoints(\n  vcServiceUrl: UrlString,\n): VerifiableCredentialApiConfiguration[\"specCompliant\"] {\n  return {\n    issuerService: new URL(\"/credentials/issue\", vcServiceUrl).toString(),\n    issuerCredentialAll: new URL(\"/credentials\", vcServiceUrl).toString(),\n    statusService: new URL(\"/credentials/status\", vcServiceUrl).toString(),\n    holderPresentationAll: new URL(\"/presentations\", vcServiceUrl).toString(),\n    derivationService: new URL(\"/credentials/derive\", vcServiceUrl).toString(),\n    exchangeService: new URL(\"/exchanges\", vcServiceUrl).toString(),\n    proveService: new URL(\"/presentations/prove\", vcServiceUrl).toString(),\n    queryService: new URL(\"/query\", vcServiceUrl).toString(),\n    credentialVerifierService: new URL(\n      \"/credentials/verify\",\n      vcServiceUrl,\n    ).toString(),\n    presentationVerifierService: new URL(\n      \"/presentations/verify\",\n      vcServiceUrl,\n    ).toString(),\n  };\n}\n\n/**\n * Discover the available services for a given VC service provider. The detail of\n * some of these services are given by the [W3C VC API](https://github.com/w3c-ccg/vc-api/).\n *\n * The returned value has two entries at its top-level, `legacy` and `specCompliant`.\n * The former reflects the legacy (default) behavior, and relies on an ad-hoc discovery\n * mechanism. The latter follows what the VC-API specification requires.\n *\n * Note that since the specification only mandates URL patterns, what the discovery\n * gets you is the URL where the endpoint should be available **if it is present**.\n * Whether it actually is available or not is something you cannot assume and must\n * explicitly check.\n *\n * @example\n * Here is how the spec-compliant endpoints are discovered:\n * ```\n * const config = await getVerifiableCredentialApiConfiguration(\"https://example.org/vc-provider\");\n * const issuer = config.specCompliant.issuerService;\n * ```\n *\n * Here is how legacy endpoints are accessed:\n * ```\n * const config = await getVerifiableCredentialApiConfiguration(\"https://example.org/vc-provider\");\n * const legacyIssuer = config.legacy.issuerService;\n *```\n * @param vcServiceUrl The URL of the VC services provider. Only the domain is relevant, any provided path will be ignored.\n * @returns A map of the services available and their URLs.\n * @since 0.2.0\n */\nexport async function getVerifiableCredentialApiConfiguration(\n  vcServiceUrl: URL | UrlString,\n): Promise<VerifiableCredentialApiConfiguration> {\n  const legacyEndpoints = await discoverLegacyEndpoints(\n    vcServiceUrl.toString(),\n  );\n  const specEndpoints = discoverSpecCompliantEndpoints(vcServiceUrl.toString());\n  return {\n    ...legacyEndpoints,\n    legacy: legacyEndpoints,\n    specCompliant: specEndpoints,\n  };\n}\n\n// eslint-disable-next-line camelcase\nexport function internal_applyDataset<T extends { id?: string }>(\n  vc: T,\n  store: DatasetCore,\n  options?: ParseOptions & {\n    includeVcProperties?: boolean;\n    additionalProperties?: Record<string, unknown>;\n    requireId?: boolean;\n  },\n): DatasetCore {\n  return Object.freeze({\n    ...(options?.requireId !== false && { id: vc.id }),\n    ...(options?.includeVcProperties && vc),\n    ...options?.additionalProperties,\n    // Make this a DatasetCore without polluting the object with\n    // all of the properties present in the N3.Store\n    [Symbol.iterator]() {\n      return store[Symbol.iterator]();\n    },\n    has(quad: Quad) {\n      return store.has(quad);\n    },\n    match(...args: Parameters<DatasetCore[\"match\"]>) {\n      return store.match(...args);\n    },\n    add() {\n      throw new Error(\"Cannot mutate this dataset\");\n    },\n    delete() {\n      throw new Error(\"Cannot mutate this dataset\");\n    },\n    get size() {\n      return store.size;\n    },\n    // For backwards compatibility the dataset properties\n    // SHOULD NOT be included when we JSON.stringify the object\n    toJSON() {\n      return vc;\n    },\n  });\n}\n\n/**\n * @hidden\n */\nexport async function verifiableCredentialToDataset<T extends { id?: string }>(\n  vc: T,\n  options?: ParseOptions & {\n    includeVcProperties: true;\n    additionalProperties?: Record<string, unknown>;\n    requireId?: true;\n  },\n): Promise<T & DatasetWithId>;\nexport async function verifiableCredentialToDataset<T extends { id?: string }>(\n  vc: T,\n  options?: ParseOptions & {\n    includeVcProperties?: boolean;\n    additionalProperties?: Record<string, unknown>;\n    requireId?: true;\n  },\n): Promise<DatasetWithId>;\nexport async function verifiableCredentialToDataset<T extends { id?: string }>(\n  vc: T,\n  options: ParseOptions & {\n    includeVcProperties: true;\n    additionalProperties?: Record<string, unknown>;\n    requireId: false;\n  },\n): Promise<T & DatasetCore>;\nexport async function verifiableCredentialToDataset<T extends { id?: string }>(\n  vc: T,\n  options?: ParseOptions & {\n    includeVcProperties?: boolean;\n    additionalProperties?: Record<string, unknown>;\n    requireId?: boolean;\n  },\n): Promise<DatasetCore>;\nexport async function verifiableCredentialToDataset<T extends { id?: string }>(\n  vc: T,\n  options?: ParseOptions & {\n    includeVcProperties?: boolean;\n    additionalProperties?: Record<string, unknown>;\n    requireId?: boolean;\n  },\n): Promise<DatasetCore> {\n  let store: DatasetCore;\n  try {\n    store = await jsonLdToStore(vc, options);\n  } catch (e) {\n    throw new Error(\n      `Parsing the Verifiable Credential as JSON-LD failed: ${e}`,\n    );\n  }\n\n  if (options?.requireId !== false && typeof vc.id !== \"string\") {\n    throw new Error(\n      `Expected vc.id to be a string, found [${\n        vc.id\n      }] of type [${typeof vc.id}] on ${JSON.stringify(vc, null, 2)}`,\n    );\n  }\n\n  return internal_applyDataset(vc as { id: string }, store, options);\n}\n\nexport function hasId(vc: unknown): vc is { id: string } {\n  return (\n    typeof vc === \"object\" &&\n    vc !== null &&\n    typeof (vc as { id: unknown }).id === \"string\"\n  );\n}\n\n/**\n * @hidden\n */\n// eslint-disable-next-line camelcase\nexport async function internal_getVerifiableCredentialFromResponse(\n  vcUrl: UrlString | undefined,\n  response: Response,\n  options: ParseOptions & {\n    returnLegacyJsonld: false;\n    skipValidation?: boolean;\n  },\n): Promise<DatasetWithId>;\n/**\n * @deprecated Deprecated in favour of setting returnLegacyJsonld: false. This will be the default value in future\n * versions of this library.\n */\nexport async function internal_getVerifiableCredentialFromResponse(\n  vcUrl: UrlString | undefined,\n  response: Response,\n  options?: ParseOptions & {\n    returnLegacyJsonld?: true;\n    skipValidation?: boolean;\n    normalize?: (object: VerifiableCredentialBase) => VerifiableCredentialBase;\n  },\n): Promise<VerifiableCredential>;\n/**\n * @deprecated Deprecated in favour of setting returnLegacyJsonld: false. This will be the default value in future\n * versions of this library.\n */\nexport async function internal_getVerifiableCredentialFromResponse(\n  vcUrl: UrlString | undefined,\n  response: Response,\n  options?: ParseOptions & {\n    returnLegacyJsonld?: boolean;\n    skipValidation?: boolean;\n    noVerify?: boolean;\n  },\n): Promise<DatasetWithId>;\nexport async function internal_getVerifiableCredentialFromResponse(\n  vcUrlInput: UrlString | undefined,\n  response: Response,\n  options?: ParseOptions & {\n    returnLegacyJsonld?: boolean;\n    skipValidation?: boolean;\n    normalize?: (object: VerifiableCredentialBase) => VerifiableCredentialBase;\n  },\n): Promise<DatasetWithId> {\n  const returnLegacy = options?.returnLegacyJsonld !== false;\n  let vc: unknown | VerifiableCredentialBase;\n  let vcUrl = vcUrlInput;\n  try {\n    vc = await response.json();\n\n    if (typeof vcUrl !== \"string\") {\n      if (!isUnknownObject(vc) || !(\"id\" in vc) || typeof vc.id !== \"string\") {\n        throw new Error(\"Cannot establish id of verifiable credential\");\n      }\n      vcUrl = vc.id;\n    }\n\n    // If you're wondering why this is not inside the if (returnLegacy) condition outside this try/catch statement\n    // see https://github.com/inrupt/solid-client-vc-js/pull/849#discussion_r1405853022\n    if (returnLegacy) {\n      vc = normalizeVc(vc);\n    }\n  } catch (e) {\n    throw new Error(\n      `Parsing the Verifiable Credential [${vcUrl}] as JSON failed: ${e}`,\n    );\n  }\n\n  if (returnLegacy) {\n    if (!options?.skipValidation && !isVerifiableCredential(vc)) {\n      throw new Error(\n        `The value received from [${vcUrl}] is not a Verifiable Credential`,\n      );\n    }\n    if (options?.normalize) {\n      vc = options.normalize(vc as VerifiableCredentialBase);\n    }\n    return verifiableCredentialToDataset(vc as VerifiableCredentialBase, {\n      allowContextFetching: options?.allowContextFetching,\n      baseIRI: options?.baseIRI,\n      contexts: options?.contexts,\n      includeVcProperties: true,\n    });\n  }\n\n  if (!hasId(vc)) {\n    throw new Error(\n      \"Verifiable credential is not an object, or does not have an id\",\n    );\n  }\n  const parsedVc = await verifiableCredentialToDataset(vc, {\n    allowContextFetching: options.allowContextFetching,\n    baseIRI: options.baseIRI,\n    contexts: options.contexts,\n    includeVcProperties: false,\n  });\n\n  if (\n    !options.skipValidation &&\n    !isRdfjsVerifiableCredential(parsedVc, namedNode(parsedVc.id))\n  ) {\n    throw new Error(\n      `The value received from [${vcUrl}] is not a Verifiable Credential`,\n    );\n  }\n  return parsedVc;\n}\n\n/**\n * Dereference a VC URL, and verify that the resulting content is valid.\n *\n * @param vcUrl The URL of the VC.\n * @param options Options to customize the function behavior.\n * - options.fetch: Specify a WHATWG-compatible authenticated fetch.\n * - options.returnLegacyJsonld: Include the normalized JSON-LD in the response\n * @returns The dereferenced VC if valid. Throws otherwise.\n * @since 0.4.0\n */\nexport async function getVerifiableCredential(\n  vcUrl: UrlString,\n  options: ParseOptions & {\n    fetch?: typeof fetch;\n    skipValidation?: boolean;\n    returnLegacyJsonld: false;\n    normalize?: (object: VerifiableCredentialBase) => VerifiableCredentialBase;\n  },\n): Promise<DatasetWithId>;\n/**\n * Dereference a VC URL, and verify that the resulting content is valid.\n *\n * @param vcUrl The URL of the VC.\n * @param options Options to customize the function behavior.\n * - options.fetch: Specify a WHATWG-compatible authenticated fetch.\n * - options.returnLegacyJsonld: Include the normalized JSON-LD in the response\n * @returns The dereferenced VC if valid. Throws otherwise.\n * @since 0.4.0\n * @deprecated Deprecated in favour of setting returnLegacyJsonld: false. This will be the default value in future\n * versions of this library.\n */\nexport async function getVerifiableCredential(\n  vcUrl: UrlString,\n  options?: ParseOptions & {\n    fetch?: typeof fetch;\n    skipValidation?: boolean;\n    returnLegacyJsonld?: true;\n    normalize?: (object: VerifiableCredentialBase) => VerifiableCredentialBase;\n  },\n): Promise<VerifiableCredential>;\n/**\n * Dereference a VC URL, and verify that the resulting content is valid.\n *\n * @param vcUrl The URL of the VC.\n * @param options Options to customize the function behavior.\n * - options.fetch: Specify a WHATWG-compatible authenticated fetch.\n * - options.returnLegacyJsonld: Include the normalized JSON-LD in the response\n * @returns The dereferenced VC if valid. Throws otherwise.\n * @since 0.4.0\n * @deprecated Deprecated in favour of setting returnLegacyJsonld: false. This will be the default value in future\n * versions of this library.\n */\nexport async function getVerifiableCredential(\n  vcUrl: UrlString,\n  options?: ParseOptions & {\n    fetch?: typeof fetch;\n    skipValidation?: boolean;\n    returnLegacyJsonld?: boolean;\n    normalize?: (object: VerifiableCredentialBase) => VerifiableCredentialBase;\n  },\n): Promise<DatasetWithId>;\nexport async function getVerifiableCredential(\n  vcUrl: UrlString,\n  options?: ParseOptions & {\n    fetch?: typeof fetch;\n    skipValidation?: boolean;\n    returnLegacyJsonld?: boolean;\n    normalize?: (object: VerifiableCredentialBase) => VerifiableCredentialBase;\n  },\n): Promise<DatasetWithId> {\n  const authFetch = options?.fetch ?? fetch;\n  const response = await authFetch(vcUrl);\n\n  if (!response.ok) {\n    throw new Error(\n      `Fetching the Verifiable Credential [${vcUrl}] failed: ${response.status} ${response.statusText}`,\n    );\n  }\n\n  return internal_getVerifiableCredentialFromResponse(vcUrl, response, options);\n}\n","//\n// Copyright Inrupt Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to use,\n// copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n// Software, and to permit persons to whom the Software is furnished to do so,\n// subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n\n/**\n * @module issue\n */\n\nimport type {\n  Iri,\n  JsonLd,\n  VerifiableCredential,\n  VerifiableCredentialBase,\n  DatasetWithId,\n} from \"../common/common\";\nimport {\n  concatenateContexts,\n  defaultContext,\n  defaultCredentialTypes,\n  // eslint-disable-next-line camelcase\n  internal_getVerifiableCredentialFromResponse,\n} from \"../common/common\";\n\ntype OptionsType = {\n  fetch?: typeof fetch;\n  returnLegacyJsonld?: boolean;\n};\n\n/**\n * Request that a given Verifiable Credential (VC) Issuer issues a VC containing\n * the provided claims. The VC Issuer is expected to implement the [W3C VC Issuer HTTP API](https://w3c-ccg.github.io/vc-api/issuer.html).\n *\n * @param issuerEndpoint The `/issue` endpoint of the VC Issuer.\n * @param subjectId The identifier of the VC claims' subject.\n * @param subjectClaims Claims about the subject that will be attested by the VC.\n * @param credentialClaims Claims about the credential itself, rather than its subject, e.g. credential type or expiration.\n * @param options\n * - options.fetch: An alternative `fetch` function to make the HTTP request, compatible with the browser-native [fetch API](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/fetch#parameters).\n * This can be typically used for authentication. Note that if it is omitted, and\n * `@inrupt/solid-client-authn-browser` is in your dependencies, the default session\n * is picked up.\n * - options.returnLegacyJsonld: Include the normalized JSON-LD in the response\n * @returns the VC returned by the Issuer if the request is successful. Otherwise, an error is thrown.\n * @since 0.1.0\n */\nexport async function issueVerifiableCredential(\n  issuerEndpoint: Iri,\n  subjectClaims: JsonLd,\n  credentialClaims: JsonLd,\n  options: {\n    fetch?: typeof fetch;\n    returnLegacyJsonld: false;\n  },\n): Promise<DatasetWithId>;\n/**\n * Request that a given Verifiable Credential (VC) Issuer issues a VC containing\n * the provided claims. The VC Issuer is expected to implement the [W3C VC Issuer HTTP API](https://w3c-ccg.github.io/vc-api/issuer.html).\n *\n * @param issuerEndpoint The `/issue` endpoint of the VC Issuer.\n * @param subjectId The identifier of the VC claims' subject.\n * @param subjectClaims Claims about the subject that will be attested by the VC.\n * @param credentialClaims Claims about the credential itself, rather than its subject, e.g. credential type or expiration.\n * @param options\n * - options.fetch: An alternative `fetch` function to make the HTTP request, compatible with the browser-native [fetch API](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/fetch#parameters).\n * This can be typically used for authentication. Note that if it is omitted, and\n * `@inrupt/solid-client-authn-browser` is in your dependencies, the default session\n * is picked up.\n * - options.returnLegacyJsonld: Include the normalized JSON-LD in the response\n * @returns the VC returned by the Issuer if the request is successful. Otherwise, an error is thrown.\n * @since 0.1.0\n * @deprecated Deprecated in favour of setting returnLegacyJsonld: false. This will be the default value in future\n * versions of this library.\n */\nexport async function issueVerifiableCredential(\n  issuerEndpoint: Iri,\n  subjectClaims: JsonLd,\n  credentialClaims?: JsonLd,\n  options?: {\n    fetch?: typeof fetch;\n    returnLegacyJsonld?: true;\n    normalize?: (object: VerifiableCredentialBase) => VerifiableCredentialBase;\n  },\n): Promise<VerifiableCredential>;\n/**\n * Request that a given Verifiable Credential (VC) Issuer issues a VC containing\n * the provided claims. The VC Issuer is expected to implement the [W3C VC Issuer HTTP API](https://w3c-ccg.github.io/vc-api/issuer.html).\n *\n * @param issuerEndpoint The `/issue` endpoint of the VC Issuer.\n * @param subjectId The identifier of the VC claims' subject.\n * @param subjectClaims Claims about the subject that will be attested by the VC.\n * @param credentialClaims Claims about the credential itself, rather than its subject, e.g. credential type or expiration.\n * @param options\n * - options.fetch: An alternative `fetch` function to make the HTTP request, compatible with the browser-native [fetch API](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/fetch#parameters).\n * This can be typically used for authentication. Note that if it is omitted, and\n * `@inrupt/solid-client-authn-browser` is in your dependencies, the default session\n * is picked up.\n * - options.returnLegacyJsonld: Include the normalized JSON-LD in the response\n * @returns the VC returned by the Issuer if the request is successful. Otherwise, an error is thrown.\n * @since 0.1.0\n * @deprecated Deprecated in favour of setting returnLegacyJsonld: false. This will be the default value in future\n * versions of this library.\n */\nexport async function issueVerifiableCredential(\n  issuerEndpoint: Iri,\n  subjectClaims: JsonLd,\n  credentialClaims?: JsonLd,\n  options?: {\n    fetch?: typeof fetch;\n    returnLegacyJsonld?: boolean;\n    normalize?: (object: VerifiableCredentialBase) => VerifiableCredentialBase;\n  },\n): Promise<DatasetWithId>;\nexport async function issueVerifiableCredential(\n  issuerEndpoint: Iri,\n  subjectClaims: JsonLd,\n  credentialClaims: JsonLd | undefined,\n  options?: OptionsType,\n): Promise<DatasetWithId> {\n  const internalOptions = { ...options };\n  if (internalOptions.fetch === undefined) {\n    internalOptions.fetch = fetch;\n  }\n\n  // credentialClaims should contain all the claims, but not the context.\n  const { \"@context\": subjectClaimsContext, ...contextlessSubjectClaims } =\n    subjectClaims;\n\n  // When we add proper JSONLD parsing support, the following should be replaced.\n  const {\n    \"@context\": credentialClaimsContext,\n    ...contextlessCredentialClaims\n  } = credentialClaims !== undefined ? credentialClaims : { \"@context\": [] };\n\n  const { type: credentialTypeClaims, ...nonTypeCredentialClaims } =\n    contextlessCredentialClaims;\n\n  let credentialTypes = [];\n  if (credentialTypeClaims !== undefined) {\n    credentialTypes = Array.isArray(credentialTypeClaims)\n      ? credentialTypeClaims\n      : [credentialTypeClaims];\n  }\n  const credentialIssueBody = {\n    // See https://w3c-ccg.github.io/vc-api/issuer.html\n    credential: {\n      \"@context\": concatenateContexts(\n        defaultContext,\n        subjectClaimsContext,\n        credentialClaimsContext,\n      ),\n      type: [...defaultCredentialTypes, ...credentialTypes],\n      ...nonTypeCredentialClaims,\n      credentialSubject: contextlessSubjectClaims,\n    },\n  };\n  const response = await (internalOptions.fetch as typeof fetch)(\n    issuerEndpoint,\n    {\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      method: \"POST\",\n      body: JSON.stringify(credentialIssueBody),\n    },\n  );\n  if (!response.ok) {\n    // TODO: use the error library when available.\n    throw new Error(\n      `The VC issuing endpoint [${issuerEndpoint}] could not successfully issue a VC: ${response.status} ${response.statusText}`,\n    );\n  }\n\n  return internal_getVerifiableCredentialFromResponse(\n    undefined,\n    response,\n    options,\n  );\n}\n\nexport default issueVerifiableCredential;\n","//\n// Copyright Inrupt Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to use,\n// copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n// Software, and to permit persons to whom the Software is furnished to do so,\n// subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\nimport type { BlankNode, DatasetCore, NamedNode } from \"@rdfjs/types\";\nimport { DataFactory } from \"n3\";\nimport { isUrl } from \"./common\";\nimport { cred, rdf } from \"./constants\";\nimport isRdfjsVerifiableCredential from \"./isRdfjsVerifiableCredential\";\n\nconst { defaultGraph } = DataFactory;\n\nexport function getHolder(\n  dataset: DatasetCore,\n  id: NamedNode | BlankNode,\n): string {\n  const holder = [...dataset.match(id, cred.holder, null, defaultGraph())];\n  if (\n    holder.length === 1 &&\n    holder[0].object.termType === \"NamedNode\" &&\n    isUrl(holder[0].object.value)\n  ) {\n    return holder[0].object.value;\n  }\n\n  throw new Error(\"Could not find a valid holder\");\n}\n\nexport function getVpSubject(data: DatasetCore) {\n  const presentations = [\n    ...data.match(null, rdf.type, cred.VerifiablePresentation, defaultGraph()),\n  ];\n  if (presentations.length !== 1) {\n    throw new Error(\n      `Expected exactly one Verifiable Presentation. Found ${presentations.length}.`,\n    );\n  }\n\n  const { subject } = presentations[0];\n  if (subject.termType !== \"BlankNode\" && subject.termType !== \"NamedNode\") {\n    throw new Error(\n      `Expected VP subject to be NamedNode or BlankNode. Instead found [${subject.value}] with termType [${subject.termType}]`,\n    );\n  }\n\n  return subject;\n}\n\nexport default function isRdfjsVerifiablePresentation(\n  dataset: DatasetCore,\n  id: NamedNode | BlankNode,\n): boolean {\n  for (const { object } of dataset.match(\n    id,\n    cred.verifiableCredential,\n    null,\n    defaultGraph(),\n  )) {\n    if (\n      object.termType !== \"NamedNode\" ||\n      !isRdfjsVerifiableCredential(dataset, object)\n    ) {\n      return false;\n    }\n  }\n\n  const holder = [...dataset.match(id, cred.holder, null, defaultGraph())];\n  return (\n    (holder.length === 0 ||\n      (holder.length === 1 &&\n        holder[0].object.termType === \"NamedNode\" &&\n        isUrl(holder[0].object.value))) &&\n    // dataset.has(quad(id, rdf.type, cred.VerifiablePresentation, defaultGraph()))\n    // FIXME: Replace with the above condition\n    dataset.match(id, rdf.type, null, defaultGraph()).size >= 1\n  );\n}\n","//\n// Copyright Inrupt Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to use,\n// copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n// Software, and to permit persons to whom the Software is furnished to do so,\n// subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n\nimport type { DatasetCore } from \"@rdfjs/types\";\nimport { DataFactory } from \"n3\";\nimport type {\n  DatasetWithId,\n  Iri,\n  VerifiableCredential,\n  VerifiableCredentialBase,\n  VerifiablePresentation,\n} from \"../common/common\";\nimport {\n  isVerifiablePresentation,\n  normalizeVp,\n  verifiableCredentialToDataset,\n} from \"../common/common\";\nimport isRdfjsVerifiableCredential from \"../common/isRdfjsVerifiableCredential\";\nimport isRdfjsVerifiablePresentation, {\n  getVpSubject,\n} from \"../common/isRdfjsVerifiablePresentation\";\nimport { type ParseOptions } from \"../parser/jsonld\";\n\nconst { namedNode } = DataFactory;\n\n/**\n * Based on https://w3c-ccg.github.io/vp-request-spec/#query-by-example.\n */\nexport type QueryByExample = {\n  type: \"QueryByExample\";\n  credentialQuery: {\n    required?: boolean;\n    reason?: string;\n    example: Partial<VerifiableCredentialBase> & {\n      credentialSchema?: {\n        id: string;\n        type: string;\n      };\n      trustedIssuer?: {\n        required: boolean;\n        issuer: string;\n      }[];\n    };\n  }[];\n};\n\n/**\n * A VP request is a standard way of getting a Verifiable Presentation matching\n * the requestor's needs.\n *\n * Note: Currently, only the QueryByExample type is implemented, but support for\n * other query types may be added in the future.\n */\nexport type VerifiablePresentationRequest = {\n  query: QueryByExample[];\n  challenge?: string;\n  domain?: string;\n};\n\n/**\n * @hidden\n */\nexport interface ParsedVerifiablePresentation\n  extends VerifiablePresentation,\n    DatasetCore {\n  verifiableCredential: VerifiableCredential[];\n}\n\nexport type MinimalPresentation = {\n  verifiableCredential: DatasetWithId[];\n} & DatasetCore;\n\n/**\n * Send a Verifiable Presentation Request to a query endpoint in order to retrieve\n * all Verifiable Credentials matching the query, wrapped in a single Presentation.\n * \n * @example The following shows how to query for credentials of a certain type. Adding\n * a reason to the request is helpful when interacting with a user. The resulting\n * Verifiable Presentation will wrap zero or more Verifiable Credentials.\n * \n * ```\n * const verifiablePresentation = await query(\n    \"https://example.org/query\", { \n      query: [{\n        type: \"QueryByExample\",\n        credentialQuery: [\n          {\n            reason: \"Some reason\",\n            example: {\n              type: [\"SomeCredentialType\"],\n            },\n          },\n        ],\n      }]\n    },\n    { fetch: session.fetch }\n  );\n * ```\n *\n * @param queryEndpoint URL of the query endpoint.\n * @param vpRequest VP Request object, compliant with https://w3c-ccg.github.io/vp-request-spec\n * @param options Options object, including an authenticated `fetch`.\n * @returns The resulting Verifiable Presentation wrapping all the Credentials matching the query.\n */\nexport async function query(\n  queryEndpoint: Iri,\n  vpRequest: VerifiablePresentationRequest,\n  options: ParseOptions & {\n    fetch?: typeof fetch;\n    returnLegacyJsonld: false;\n    normalize?: (vc: VerifiableCredentialBase) => VerifiableCredentialBase;\n  },\n): Promise<MinimalPresentation>;\n/**\n * @deprecated Use RDFJS API instead of relying on the JSON structure by setting `returnLegacyJsonld` to false\n */\nexport async function query(\n  queryEndpoint: Iri,\n  vpRequest: VerifiablePresentationRequest,\n  options?: ParseOptions & {\n    fetch?: typeof fetch;\n    returnLegacyJsonld?: true;\n    normalize?: (vc: VerifiableCredentialBase) => VerifiableCredentialBase;\n  },\n): Promise<ParsedVerifiablePresentation>;\n/**\n * @deprecated Use RDFJS API instead of relying on the JSON structure by setting `returnLegacyJsonld` to false\n */\nexport async function query(\n  queryEndpoint: Iri,\n  vpRequest: VerifiablePresentationRequest,\n  options?: ParseOptions & {\n    fetch?: typeof fetch;\n    returnLegacyJsonld?: boolean;\n    normalize?: (vc: VerifiableCredentialBase) => VerifiableCredentialBase;\n  },\n): Promise<ParsedVerifiablePresentation | MinimalPresentation>;\nexport async function query(\n  queryEndpoint: Iri,\n  vpRequest: VerifiablePresentationRequest,\n  options: ParseOptions &\n    Partial<{\n      fetch: typeof fetch;\n      returnLegacyJsonld?: boolean;\n      normalize?: (vc: VerifiableCredentialBase) => VerifiableCredentialBase;\n    }> = {},\n): Promise<ParsedVerifiablePresentation | MinimalPresentation> {\n  const internalOptions = { ...options };\n  if (internalOptions.fetch === undefined) {\n    internalOptions.fetch = fetch;\n  }\n  const response = await internalOptions.fetch(queryEndpoint, {\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    method: \"POST\",\n    body: JSON.stringify(vpRequest),\n  });\n  if (!response.ok) {\n    throw new Error(\n      `The query endpoint [${queryEndpoint}] returned an error: ${response.status} ${response.statusText}`,\n    );\n  }\n\n  // Return to this approach once https://github.com/rubensworks/jsonld-streaming-parser.js/issues/122 is resolved\n  // if (options?.returnLegacyJsonld === false) {\n  //   try {\n  //     const vpJson = await response.json();\n  //     console.log(JSON.stringify(vpJson, null, 2), null, 2)\n  //     const store = await jsonLdToStore(vpJson);\n  //     const vp = [...store.match(null, rdf.type, cred.VerifiablePresentation, defaultGraph())]\n\n  //     if (vp.length !== 1) {\n  //       throw new Error(`Expected exactly 1 Verifiable Presentation. Found ${vp.length}.`)\n  //     }\n\n  //     const [{ subject }] = vp;\n\n  //     if (subject.termType !== 'BlankNode' && subject.termType !== 'NamedNode') {\n  //       throw new Error(`Expected VP to be a Blank Node or Named Node. Found [${subject.value}] of type [${subject.termType}].`)\n  //     }\n\n  //     if (!isRdfjsVerifiablePresentation(store, subject)) {\n  //       throw new Error(\n  //         `The holder [${queryEndpoint}] did not return a Verifiable Presentation: ${JSON.stringify(\n  //           vpJson, null, 2\n  //         )}`,\n  //       );\n  //     }\n\n  //     // In the future we want to get rid of this and get the verifiableCredential ids from the store\n  //     // the reason we need this for now is because we need the verifiableCredential JSON object for\n  //     // the toJSON method.\n  //     const verifiableCredential: DatasetWithId[] = vpJson.verifiableCredential.map((vc: unknown) => {\n  //       if (vc === null || typeof vc !== 'object') {\n  //         throw new Error(`Verifiable Credential entry is not an object`);\n  //       }\n\n  //       if (!('id' in vc) || typeof vc.id !== 'string') {\n  //         throw new Error(`Verifiable credential is missing a string id`);\n  //       }\n\n  //       const c = internal_applyDataset(vc as { id: string }, store, options)\n\n  //       if (!isRdfjsVerifiableCredential(store, namedNode(c.id))) {\n  //         throw new Error(`[${c.id}] is not a valid Verifiable Credential`);\n  //       }\n  //     });\n  //     return internal_applyDataset(vpJson, store, {\n  //       ...options,\n  //       additionalProperties: {\n  //         verifiableCredential\n  //       }\n  //     });\n  //   } catch (e) {\n  //     throw new Error(\n  //       `The holder [${queryEndpoint}] did not return a valid JSON response: parsing failed with error ${e}`,\n  //     );\n  //   }\n  // }\n\n  // All code below here should is deprecated\n  let data: VerifiablePresentation & DatasetCore;\n  let rawData: VerifiablePresentation;\n  try {\n    rawData = await response.json();\n\n    if (options.returnLegacyJsonld !== false) {\n      rawData = normalizeVp(rawData);\n    }\n    data = (await verifiableCredentialToDataset<VerifiablePresentation>(\n      rawData,\n      {\n        includeVcProperties: options.returnLegacyJsonld !== false,\n        additionalProperties:\n          typeof rawData.id === \"string\" ? { id: rawData.id } : {},\n        requireId: false,\n        // This is a lie depending on how returnLegacyJsonld is set\n      },\n    )) as VerifiablePresentation & DatasetCore;\n  } catch (e) {\n    throw new Error(\n      `The holder [${queryEndpoint}] did not return a valid JSON response: parsing failed with error ${e}`,\n    );\n  }\n\n  const subject =\n    typeof data.id === \"string\" ? namedNode(data.id) : getVpSubject(data);\n  if (\n    options.returnLegacyJsonld === false\n      ? !isRdfjsVerifiablePresentation(data, subject)\n      : !isVerifiablePresentation(data)\n  ) {\n    throw new Error(\n      `The holder [${queryEndpoint}] did not return a Verifiable Presentation: ${JSON.stringify(\n        data,\n      )}`,\n    );\n  }\n\n  const newVerifiableCredential: DatasetWithId[] = [];\n  if (\n    rawData.verifiableCredential &&\n    Array.isArray(rawData.verifiableCredential)\n  ) {\n    for (let i = 0; i < rawData.verifiableCredential.length; i += 100) {\n      newVerifiableCredential.push(\n        // Limit concurrency to avoid memory overflows. For details see\n        // https://github.com/inrupt/solid-client-vc-js/pull/849#discussion_r1377400688\n        // eslint-disable-next-line no-await-in-loop\n        ...(await Promise.all(\n          rawData.verifiableCredential\n            .slice(i, i + 100)\n            .map(async (_vc: VerifiableCredentialBase) => {\n              let vc = _vc;\n              if (typeof vc !== \"object\" || vc === null) {\n                throw new Error(`Verifiable Credentail is an invalid object`);\n              }\n\n              if (options.normalize) {\n                vc = options.normalize(vc);\n              }\n\n              const res = await verifiableCredentialToDataset(vc, {\n                ...options,\n                includeVcProperties: options.returnLegacyJsonld !== false,\n              });\n\n              if (!isRdfjsVerifiableCredential(res, namedNode(res.id))) {\n                throw new Error(\n                  `[${res.id}] is not a Valid Verifiable Credential`,\n                );\n              }\n\n              return res;\n            }),\n        )),\n      );\n    }\n  }\n  return {\n    ...data,\n    verifiableCredential: newVerifiableCredential,\n  } as\n    | ParsedVerifiablePresentation\n    | ({ verifiableCredential: DatasetWithId[] } & DatasetCore);\n}\n","//\n// Copyright Inrupt Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to use,\n// copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n// Software, and to permit persons to whom the Software is furnished to do so,\n// subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n\nimport type {\n  Iri,\n  VerifiableCredential,\n  VerifiableCredentialBase,\n  DatasetWithId,\n} from \"../common/common\";\nimport { concatenateContexts, defaultContext } from \"../common/common\";\nimport type { VerifiablePresentationRequest } from \"./query\";\nimport { query } from \"./query\";\n\nconst INCLUDE_EXPIRED_VC_OPTION = \"ExpiredVerifiableCredential\" as const;\n\n/**\n * This creates the proprietary data structure used for querying the legacy /derive\n * endpoint of ESS.\n *\n * @param vcShape The VC example used for the VP request\n * @param includeExpiredVc An option to query for expired VC as well\n * @returns A legacy object expected by the /derive endpoint of the ESS 2.0 VC service\n */\nfunction buildLegacyQuery(\n  vcShape: Partial<VerifiableCredentialBase>,\n  includeExpiredVc: boolean,\n) {\n  // credentialClaims should contain all the claims, but not the context.\n  const { \"@context\": claimsContext, ...credentialClaims } = vcShape;\n  return {\n    // See https://w3c-ccg.github.io/vc-api/holder.html\n    verifiableCredential: {\n      \"@context\": concatenateContexts(defaultContext, claimsContext),\n      ...credentialClaims,\n    },\n    options: {\n      include: includeExpiredVc ? INCLUDE_EXPIRED_VC_OPTION : undefined,\n    },\n  };\n}\n\n/**\n * See https://w3c-ccg.github.io/vp-request-spec/#query-by-example.\n * @param vcShape The VC example used for the VP request\n * @returns A Query by Example VP Request based on the provided example.\n */\nfunction buildQueryByExample(\n  vcShape: Partial<VerifiableCredentialBase>,\n): VerifiablePresentationRequest {\n  return {\n    query: [\n      {\n        type: \"QueryByExample\",\n        credentialQuery: [\n          {\n            example: vcShape,\n          },\n        ],\n      },\n    ],\n  };\n}\n\n/**\n * Look up VCs from a given holder according to a subset of their claims, such as\n * the VC type, or any property associated to the subject in the VC. The holder\n * is expected to implement the [W3C VC Holder HTTP API](https://w3c-ccg.github.io/vc-api/holder.html).\n *\n * @param holderEndpoint The `/derive` endpoint of the holder.\n * @param vcShape The subset of claims you expect the matching VCs to contain.\n * @param options Optional parameter:\n * - `options.fetch`: An alternative `fetch` function to make the HTTP request, compatible with the browser-native [fetch API](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/fetch#parameters).\n * This can be typically used for authentication. Note that if it is omitted, and\n * `@inrupt/solid-client-authn-browser` is in your dependencies, the default session\n * is picked up.\n * - `options.includeExpiredVc`: include expired VC matching the shape in the\n * result set.\n * - `options.returnLegacyJsonld`: : Include the normalized JSON-LD in the response\n * @returns A list of VCs matching the given VC shape. The list may be empty if\n * the holder does not hold any matching VC.\n * @since 0.1.0\n */\nexport async function getVerifiableCredentialAllFromShape(\n  holderEndpoint: Iri,\n  vcShape: Partial<VerifiableCredentialBase>,\n  options: {\n    fetch?: typeof fetch;\n    includeExpiredVc?: boolean;\n    returnLegacyJsonld: false;\n  },\n): Promise<DatasetWithId[]>;\n/**\n * Look up VCs from a given holder according to a subset of their claims, such as\n * the VC type, or any property associated to the subject in the VC. The holder\n * is expected to implement the [W3C VC Holder HTTP API](https://w3c-ccg.github.io/vc-api/holder.html).\n *\n * @param holderEndpoint The `/derive` endpoint of the holder.\n * @param vcShape The subset of claims you expect the matching VCs to contain.\n * @param options Optional parameter:\n * - `options.fetch`: An alternative `fetch` function to make the HTTP request, compatible with the browser-native [fetch API](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/fetch#parameters).\n * This can be typically used for authentication. Note that if it is omitted, and\n * `@inrupt/solid-client-authn-browser` is in your dependencies, the default session\n * is picked up.\n * - `options.includeExpiredVc`: include expired VC matching the shape in the\n * result set.\n * - `options.returnLegacyJsonld`: : Include the normalized JSON-LD in the response\n * @returns A list of VCs matching the given VC shape. The list may be empty if\n * the holder does not hold any matching VC.\n * @since 0.1.0\n * @deprecated Deprecated in favour of setting returnLegacyJsonld: false. This will be the default value in future\n * versions of this library.\n */\nexport async function getVerifiableCredentialAllFromShape(\n  holderEndpoint: Iri,\n  vcShape: Partial<VerifiableCredentialBase>,\n  options?: {\n    fetch?: typeof fetch;\n    includeExpiredVc?: boolean;\n    returnLegacyJsonld?: true;\n    normalize?: (vc: VerifiableCredentialBase) => VerifiableCredentialBase;\n  },\n): Promise<VerifiableCredential[]>;\n/**\n * Look up VCs from a given holder according to a subset of their claims, such as\n * the VC type, or any property associated to the subject in the VC. The holder\n * is expected to implement the [W3C VC Holder HTTP API](https://w3c-ccg.github.io/vc-api/holder.html).\n *\n * @param holderEndpoint The `/derive` endpoint of the holder.\n * @param vcShape The subset of claims you expect the matching VCs to contain.\n * @param options Optional parameter:\n * - `options.fetch`: An alternative `fetch` function to make the HTTP request, compatible with the browser-native [fetch API](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/fetch#parameters).\n * This can be typically used for authentication. Note that if it is omitted, and\n * `@inrupt/solid-client-authn-browser` is in your dependencies, the default session\n * is picked up.\n * - `options.includeExpiredVc`: include expired VC matching the shape in the\n * result set.\n * - `options.returnLegacyJsonld`: : Include the normalized JSON-LD in the response\n * @returns A list of VCs matching the given VC shape. The list may be empty if\n * the holder does not hold any matching VC.\n * @since 0.1.0\n * @deprecated Deprecated in favour of setting returnLegacyJsonld: false. This will be the default value in future\n * versions of this library.\n */\nexport async function getVerifiableCredentialAllFromShape(\n  holderEndpoint: Iri,\n  vcShape: Partial<VerifiableCredentialBase>,\n  options?: {\n    fetch?: typeof fetch;\n    includeExpiredVc?: boolean;\n    returnLegacyJsonld?: boolean;\n    normalize?: (vc: VerifiableCredentialBase) => VerifiableCredentialBase;\n  },\n): Promise<DatasetWithId[]>;\nexport async function getVerifiableCredentialAllFromShape(\n  holderEndpoint: Iri,\n  vcShape: Partial<VerifiableCredentialBase>,\n  options?: {\n    fetch?: typeof fetch;\n    includeExpiredVc?: boolean;\n    returnLegacyJsonld?: boolean;\n    normalize?: (vc: VerifiableCredentialBase) => VerifiableCredentialBase;\n  },\n): Promise<DatasetWithId[]> {\n  const fetchFn = options?.fetch ?? fetch;\n  // The request payload depends on the target endpoint.\n  const vpRequest = holderEndpoint.endsWith(\"/query\")\n    ? // The target endpoint is spec-compliant, and uses a standard VP request.\n      // This is based on an implementation-specific assumption about the endpoint\n      // being available under the /query path.\n      buildQueryByExample(vcShape)\n    : // The target endpoint is legacy, and uses a proprietary request format.\n      (buildLegacyQuery(\n        vcShape,\n        options?.includeExpiredVc ?? false,\n        // The legacy proprietary format is casted as a VP request to be passed to the `query` function.\n      ) as unknown as VerifiablePresentationRequest);\n\n  const vp = await query(holderEndpoint, vpRequest, {\n    fetch: fetchFn,\n    returnLegacyJsonld: options?.returnLegacyJsonld,\n    normalize: options?.normalize,\n  });\n  return vp.verifiableCredential;\n}\n\nexport default getVerifiableCredentialAllFromShape;\n","//\n// Copyright Inrupt Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to use,\n// copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n// Software, and to permit persons to whom the Software is furnished to do so,\n// subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n\n/**\n * @module revoke\n */\nimport type { Iri } from \"../common/common\";\n\n/**\n * Revoke a given VC from a given issuer. This changes the status of the VC so that\n * subsequent verifications will fail. The issuer is expected to implement the\n * [W3C VC Issuer HTTP API](https://w3c-ccg.github.io/vc-api/issuer.html),\n * in particular [VC status update](https://w3c-ccg.github.io/vc-api/issuer.html#operation/updateCredentialStatus).\n *\n * @param issuerEndpoint The `/status` endpoint of the holder.\n * @param credentialId The identifier of the VC to be revoked.\n * @param options Optional parameter `options.fetch`: An alternative `fetch` function to make the HTTP request, compatible with the browser-native [fetch API](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/fetch#parameters).\n * This can be typically used for authentication. Note that if it is omitted, and\n * `@inrupt/solid-client-authn-browser` is in your dependencies, the default session\n * is picked up.\n * @since 0.1.0\n */\nexport async function revokeVerifiableCredential(\n  issuerEndpoint: Iri,\n  credentialId: Iri,\n  options?: {\n    fetch: typeof fetch;\n  },\n): Promise<void> {\n  const internalOptions = { ...options };\n  if (internalOptions.fetch === undefined) {\n    internalOptions.fetch = fetch;\n  }\n  const response = await internalOptions.fetch(issuerEndpoint, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      credentialId,\n      credentialStatus: [\n        {\n          type: \"RevocationList2020Status\",\n          status: \"1\",\n        },\n      ],\n    }),\n  });\n  if (!response.ok) {\n    throw new Error(\n      `The issuer [${issuerEndpoint}] returned an error: ${response.status} ${response.statusText}`,\n    );\n  }\n}\n\nexport default revokeVerifiableCredential;\n","//\n// Copyright Inrupt Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to use,\n// copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n// Software, and to permit persons to whom the Software is furnished to do so,\n// subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n\n/**\n * @module verify\n */\n\nimport type { UrlString } from \"@inrupt/solid-client\";\n\nimport type { DatasetCore } from \"@rdfjs/types\";\nimport { DataFactory } from \"n3\";\nimport type {\n  DatasetWithId,\n  VerifiableCredentialBase,\n  VerifiablePresentation,\n} from \"../common/common\";\nimport {\n  getVerifiableCredential,\n  getVerifiableCredentialApiConfiguration,\n  hasId,\n  verifiableCredentialToDataset,\n} from \"../common/common\";\nimport { getId, getIssuer } from \"../common/getters\";\nimport isRdfjsVerifiableCredential from \"../common/isRdfjsVerifiableCredential\";\nimport isRdfjsVerifiablePresentation, {\n  getHolder,\n  getVpSubject,\n} from \"../common/isRdfjsVerifiablePresentation\";\nimport type {\n  MinimalPresentation,\n  ParsedVerifiablePresentation,\n} from \"../lookup/query\";\nimport type { ParseOptions } from \"../parser/jsonld\";\n\nconst { namedNode } = DataFactory;\n\nasync function dereferenceVc(\n  vc: VerifiableCredentialBase | DatasetWithId | URL | UrlString,\n  options?: ParseOptions & {\n    requireId?: boolean;\n  },\n): Promise<DatasetCore> {\n  // This test passes for both URL and UrlString\n  if (!vc.toString().startsWith(\"http\")) {\n    if (typeof (vc as DatasetCore).match === \"function\") {\n      return vc as DatasetCore;\n    }\n    return verifiableCredentialToDataset(vc as VerifiableCredentialBase, {\n      requireId: true,\n    });\n  }\n  return getVerifiableCredential(vc.toString(), options);\n}\n\n/**\n * Verify that a VC is valid, i.e. :\n * - its signature matches its issuer's key\n * - it has not been revoked\n * - it isn't expired\n * These verifications are done server-side by a Verification Service, either\n * discovered from the VC Issuer or manually provided.\n *\n * @param vc The VC to verify\n * @param options Additional options\n * - `options.fetch`: An alternative `fetch` function to make the HTTP request,\n * compatible with the browser-native [fetch API](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/fetch#parameters).\n * This can be typically used for authentication.\n * - `options.verificationEndpoint`: Pass a trusted VC verification service\n *\n * @returns a JSON-shaped validation report structured accoring to the [VC Verifier API](https://w3c-ccg.github.io/vc-api/verifier.html#operation/verifyCredential).\n * @since 0.3.0\n */\nexport async function isValidVc(\n  vc: VerifiableCredentialBase | DatasetWithId | URL | UrlString,\n  options?: Partial<{\n    fetch?: typeof fetch;\n    verificationEndpoint?: UrlString;\n  }> &\n    ParseOptions,\n): Promise<{ checks: string[]; warnings: string[]; errors: string[] }> {\n  const fetcher = options?.fetch ?? fetch;\n\n  const vcObject = await dereferenceVc(vc, options);\n\n  if (\n    !hasId(vcObject) ||\n    !isRdfjsVerifiableCredential(vcObject, namedNode(getId(vcObject)))\n  ) {\n    throw new Error(\n      `The request to [${vc}] returned an unexpected response: ${JSON.stringify(\n        vcObject,\n        null,\n        \"  \",\n      )}`,\n    );\n  }\n\n  // Discover the consent endpoint from the resource part of the Access Grant.\n  const verifierEndpoint =\n    options?.verificationEndpoint ??\n    (await getVerifiableCredentialApiConfiguration(getIssuer(vcObject)))\n      .verifierService;\n\n  if (verifierEndpoint === undefined) {\n    throw new Error(\n      `The VC service provider ${getIssuer(\n        vcObject,\n      )} does not advertize for a verifier service in its .well-known/vc-configuration document`,\n    );\n  }\n\n  const response = await fetcher(verifierEndpoint, {\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    method: \"POST\",\n    body: JSON.stringify({\n      verifiableCredential: vcObject,\n    }),\n  });\n\n  if (!response.ok) {\n    throw new Error(\n      `The request to the verification endpoint [${verifierEndpoint}] failed: ${response.status} ${response.statusText}`,\n    );\n  }\n\n  try {\n    return await response.json();\n  } catch (e) {\n    throw new Error(\n      `Parsing the response of the verification service hosted at [${verifierEndpoint}] as JSON failed: ${\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        (e as any).toString()\n      }`,\n    );\n  }\n}\n\nasync function asDataset(\n  data: DatasetCore | VerifiablePresentation,\n  requireId: true,\n): Promise<DatasetWithId>;\nasync function asDataset(\n  data: DatasetCore | VerifiablePresentation,\n  requireId: boolean,\n): Promise<DatasetCore>;\nasync function asDataset(\n  data: DatasetCore | VerifiablePresentation,\n  requireId: boolean,\n): Promise<DatasetCore> {\n  return typeof (data as DatasetCore).match === \"function\"\n    ? (data as DatasetCore)\n    : verifiableCredentialToDataset(data as VerifiablePresentation, {\n        requireId,\n      });\n}\n\n/**\n * Verify that a VP is valid and content has not ben tampered with.\n *\n * @param verificationEndpoint The verification endpoint\n * @param verifiablePresentation The VP to verify\n * @param options Additional options\n * - `options.fetch`: An alternative `fetch` function to make the HTTP request,\n * compatible with the browser-native [fetch API](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/fetch#parameters).\n * This can be typically used for authentication.\n * - `options.domain`: Pass a domain\n * - `options.challenge`: Pass a challenge\n *\n * @returns a JSON-shaped validation report structured accoring to the [VP Verifier API](https://w3c-ccg.github.io/vc-api/verifier.html#operation/verifyPresentation).\n * @since\n */\nexport async function isValidVerifiablePresentation(\n  verificationEndpoint: string | null,\n  verifiablePresentation:\n    | VerifiablePresentation\n    | MinimalPresentation\n    | ParsedVerifiablePresentation,\n  options: Partial<{\n    fetch: typeof fetch;\n    domain: string;\n    challenge: string;\n  }> = {},\n): Promise<{ checks: string[]; warnings: string[]; errors: string[] }> {\n  const fetcher = options.fetch ?? fetch;\n  const dataset = await asDataset(verifiablePresentation, false);\n  const subject = getVpSubject(dataset);\n\n  if (!isRdfjsVerifiablePresentation(dataset, subject)) {\n    throw new Error(\n      `The request to [${dataset}] returned an unexpected response: ${JSON.stringify(\n        dataset,\n        null,\n        \"  \",\n      )}`,\n    );\n  }\n\n  if (verifiablePresentation.verifiableCredential) {\n    const datasets = await Promise.all(\n      verifiablePresentation.verifiableCredential.map(async (vc) => {\n        const vcDataset = await asDataset(vc, true);\n        return isRdfjsVerifiableCredential(\n          vcDataset,\n          namedNode(getId(vcDataset)),\n        );\n      }),\n    );\n    if (datasets.some((vc) => vc === false)) {\n      throw new Error(\n        `The request to [${dataset}] returned an unexpected response: ${JSON.stringify(\n          dataset,\n          null,\n          \"  \",\n        )}`,\n      );\n    }\n  }\n\n  const verifierEndpoint =\n    verificationEndpoint ??\n    (await getVerifiableCredentialApiConfiguration(getHolder(dataset, subject)))\n      .verifierService;\n\n  if (verifierEndpoint === undefined) {\n    throw new Error(\n      `The VC service provider ${getHolder(\n        dataset,\n        subject,\n      )} does not advertize for a verifier service in its .well-known/vc-configuration document`,\n    );\n  }\n\n  const response = await fetcher(verifierEndpoint, {\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    method: \"POST\",\n    body: JSON.stringify({\n      verifiablePresentation: dataset,\n      options: {\n        domain: options.domain,\n        challenge: options.challenge,\n      },\n    }),\n  });\n\n  if (!response.ok) {\n    throw new Error(\n      `The request to the verification endpoint [${verificationEndpoint}] failed: ${response.status} ${response.statusText}`,\n    );\n  }\n\n  try {\n    return await response.json();\n  } catch (e) {\n    throw new Error(\n      `Parsing the response of the verification service hosted at [${verificationEndpoint}] as JSON failed: ${\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        (e as any).toString()\n      }`,\n    );\n  }\n}\n"],"names":["CONTEXTS","namedNode","_rdf","defaultGraph"],"mappings":"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"}